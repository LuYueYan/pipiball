var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);r.prototype=t.prototype,e.prototype=new r},__awaiter=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function a(e){try{l(o.next(e))}catch(t){i(t)}}function s(e){try{l(o["throw"](e))}catch(t){i(t)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(a,s)}l((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function r(e){return function(t){return o([e,t])}}function o(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,i=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){l.label=r[1];break}if(6===r[0]&&l.label<a[1]){l.label=a[1],a=r;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(r);break}a[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(o){r=[6,o],i=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n,i,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},getSuccess=function(e){function t(t,r){var o=e.call(this)||this;return o.imgName="img_diamond_big_png",o.shareType=1,o.imgName=t,o.title=r,o}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.knowBtn?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){AdMaster.cacheBannerAd&&AdMaster.openBannerAd({width:700,height:300}),this.img.texture=RES.getRes(this.imgName),this.txt.text=""+this.title,egret.Tween.get(this.light,{loop:!0}).to({rotation:360},3e3),this.knowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.knowFun,this),this.ifShare.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ifShareFun,this)},t.prototype.knowFun=function(){AdMaster.closeBannerAd(),egret.Tween.removeTweens(this.light),1==this.shareType&&CallbackMaster.openShare(null,-1),sceneMaster.littleModal?sceneMaster.closeLittleModal():sceneMaster.closeModal()},t.prototype.ifShareFun=function(){this.shareType=1==this.shareType?2:1,this.shareImg.texture=RES.getRes("img_check_0"+this.shareType+"_png")},t}(eui.Component);__reflect(getSuccess.prototype,"getSuccess",["eui.UIComponent","egret.DisplayObject"]);var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,r){function o(o){t.call(r,o,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?o(n):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return DeviceMaster.init(this.stage.stageWidth,this.stage.stageHeight),userDataMaster.init(),[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return o.sent(),[4,RES.loadGroup("preload")];case 2:return o.sent(),e=new LoadingUI(this.stage.stageHeight),this.stage.addChild(e),[4,this.loadTheme()];case 3:return o.sent(),[4,RES.loadGroup("load",0,e)];case 4:return o.sent(),[4,RES.getResByUrl("https://lixi.h5.app81.com/minigame/game_lixi/shooting/levelArr.json",function(e){userDataMaster.levelArr=e.list},this,RES.ResourceItem.TYPE_JSON)];case 5:return o.sent(),t=this,setTimeout(function(){t.checkSuccess(e,0)},1e3),[3,7];case 6:return r=o.sent(),console.error(r),[3,7];case 7:return[2]}})})},t.prototype.checkSuccess=function(e,t){var r=this;userDataMaster.getDataSuccess?r.stage.removeChild(e):5>t&&(t++,setTimeout(function(){r.checkSuccess(e,t)},1e3))},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,r){var o=new eui.Theme("resource/default.thm.json",e.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){AdMaster.init(),CallbackMaster.init(),sceneMaster.init(this.stage),sceneMaster.changeScene(new startScene),movieMaster.init(),soundMaster.init()},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e);return t.texture=r,t},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){this.openDataContext={createDisplayObject:function(e,t,r){},postMessage:function(e){}}}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{code:""}]})})},e.prototype.onShareAppMessage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.shareAppMessage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.createUserInfoButton=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.vibrateShort=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.vibrateLong=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.navigateToMiniProgram=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.setUserCloudStorage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.getUserCloudStorage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.createRewardedVideoAd=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.createBannerAd=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.getSystemInfoSync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{screenWidth:750,screenHeight:1334}]})})},e.prototype.setStorage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.getStorage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.removeStorage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.onShow=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(r){return t={scene:"",query:{},shareTicket:"",referrerInfo:{appId:"",extraData:{type:"openMiniApp",openMiniAppId:""}}},e&&e(t),[2]})})},e.prototype.offShow=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.onHide=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.offHide=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.previewImage=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.exitMiniProgram=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.showModal=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.setClipboardData=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.getLaunchOptionsSync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.triggerGC=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,r,o){function n(e){t.call(o,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),r.call(o))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(o,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,r){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(o,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.split("/");s.pop();var l=s.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(o,generateJSON.paths[e])},this):RES.getResByUrl(l,function(r){window.JSONParseClass.setData(r),egret.callLater(function(){t.call(o,generateJSON.paths[e])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(o,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ballCom=function(){function e(){this.type=3,this.squareType=3,this.isRemoved=!1,this.init()}return e.prototype.init=function(){this.img=this.createBitmapByName(userDataMaster.bulletArr[userDataMaster.bulletIndex].img),this.img.width=82,this.img.height=86,this.img.anchorOffsetX=this.img.width/2,this.img.anchorOffsetY=this.img.height/2},e.prototype.createBody=function(e,t,r){var o=new p2.Box({width:1.92,height:1.92});return o.collisionGroup=2,o.collisionMask=5,o.sensor=!0,this.boxBody=new p2.Body({mass:100,position:[e,t],type:p2.Body.KINEMATIC}),this.boxBody.addShape(o),this.boxBody.displays=[this.img],r.addChild(this.img),egret.Tween.get(this.img,{loop:!0}).to({scaleX:.9,scaleY:1.1},200).to({scaleX:1,scaleY:1},100),this.boxBody},e.prototype.updateText=function(e,t){void 0===t&&(t=null);var r=this,o=movieMaster.getGif("bullet");o.x=this.img.x-100,o.y=this.img.y-100,e.addChild(o),o.gotoAndPlay(1,1),o.addEventListener(egret.Event.COMPLETE,function(e){o.parent&&o.parent.removeChild(o)},this),r.boxBody.shapes[0].collisionMask=0,r.isRemoved=!0,setTimeout(function(){r.boxBody.type=p2.Body.DYNAMIC,r.boxBody.gravityScale=0,r.boxBody.velocity=[0,-10],r.boxBody.angularVelocity=2;var o=(r.boxBody.position[1]-e.getPosition(935))/10;setTimeout(function(){e.world.removeBody(r.boxBody),r.img.parent&&r.img.parent.removeChild(r.img),t&&t()},1e3*o)},1e3)},e.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e+"_png");return t.texture=r,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t},e}();__reflect(ballCom.prototype,"ballCom"),window.ballCom=ballCom;var beeCom=function(){function e(){this.adaptation=0,this.power=1,this.init()}return e.prototype.init=function(){this.img=this.createBitmapByName(userDataMaster.bulletArr[userDataMaster.bulletIndex].img),this.img.width=58,this.img.height=63,this.img.anchorOffsetX=this.img.width/2,this.img.anchorOffsetY=this.img.height/4,this.against=userDataMaster.bulletArr[userDataMaster.bulletIndex].target},e.prototype.createBody=function(e,t,r){void 0===t&&(t=7.5),void 0===r&&(r=0);var o=new p2.Circle({radius:.25});return o.collisionGroup=1,o.collisionMask=2,0==r&&(r=e.getPosition(880)),this.boxBody=new p2.Body({mass:100,position:[t,r]}),this.boxBody.gravityScale=1,this.boxBody.addShape(o),e.world.addBody(this.boxBody),this.boxBody.displays=[this.img],e.addChild(this.img),this.boxBody},e.prototype.powerUp=function(e){void 0===e&&(e=1),this.power=e,2==e?this.img.texture=RES.getRes("img_lightning_02_png"):1==e&&(this.img.texture=RES.getRes(userDataMaster.bulletArr[userDataMaster.bulletIndex].img+"_png"))},e.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e+"_png");return t.texture=r,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t},e}();__reflect(beeCom.prototype,"beeCom"),window.beeCom=beeCom;var chooseSex=function(e){function t(){var t=e.call(this)||this;return t.choose=0,t}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){var e=this;e.gender_1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseGender(1)},this),e.gender_2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseGender(2)},this),e.sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.sureFun,this)},t.prototype.sureFun=function(){var e=this;e.choose>0},t.prototype.chooseGender=function(e){var t=this;if(t.sureBtn.visible=!0,t.choose!=e){t.choose=e,userDataMaster.myInfo.gender=t.choose,t["bg_"+e].visible=!0,t["img_"+e].scaleX=1,t["img_"+e].scaleY=1;var r=1==e?2:1;t["bg_"+r].visible=!1,t["img_"+r].scaleX=.8,t["img_"+r].scaleY=.8,userDataMaster.userInfoBtn&&userDataMaster.userInfoBtn.destroy();var o=t.sureBtn.y+t.y-t.anchorOffsetY;userDataMaster.createLoginBtn(244,o,262,112,function(){sceneMaster.closeModal()})}},t}(eui.Component);__reflect(chooseSex.prototype,"chooseSex",["eui.UIComponent","egret.DisplayObject"]);var gridCom=function(){function e(e,t){void 0===e&&(e=1),void 0===t&&(t=1),this.itemW=96,this.initNum=1,this.num=1,this.type=1,this.squareType=1,this.isRemoved=!1,this.num=e,this.initNum=e,this.type=t,2==t&&(this.type=1),this.init()}return e.prototype.init=function(){if(1==this.type){var e="img_diamonds_a1";Math.random()>.5&&(e="img_diamonds_c1"),this.img=this.createBitmapByName(e)}else 2==this.type?this.img=this.createBitmapByName("img_diamonds_b1"):5==this.type?this.img=this.createBitmapByName("img_diamonds_e1"):this.img=this.createBitmapByName("img_diamonds_d1");this.img.anchorOffsetX=this.img.width/2,this.img.anchorOffsetY=this.img.height/2,this.txt=new egret.BitmapText,this.font=RES.getRes("stripe_text_fnt"),this.txt.font=this.font,this.txt.text=this.num+"",this.txt.width=this.itemW,this.txt.textAlign="center",this.txt.anchorOffsetX=this.img.width/2,this.txt.anchorOffsetY=this.img.height/1.5,this.txt.scaleX=.8,this.txt.scaleY=.8},e.prototype.createBody=function(e,t,r){var o;if(2==this.type){var n=[[.95,-.95],[.95,.95],[-.95,.95]];o=new p2.Convex({vertices:n})}else o=new p2.Box({width:1.9,height:1.9});if(o.collisionGroup=6,o.collisionMask=7,this.boxBody=new p2.Body({mass:100,position:[e,t],type:p2.Body.KINEMATIC}),this.boxBody.addShape(o),6==this.type){this.boxBody.type=p2.Body.DYNAMIC,this.boxBody.gravityScale=0;var i=this,a=200+r.gridArr.length%4*100;setTimeout(function(){i.boxBody.velocity=[-.8,0]},a)}return this.boxBody.fixedRotation=!1,this.boxBody.displays=[this.img,this.txt],r.addChild(this.img),r.addChild(this.txt),this.boxBody},e.prototype.updateText=function(e,t,r){void 0===t&&(t=1),void 0===r&&(r=null);var o=new egret.BitmapText;o.font=this.font,o.text=t>this.num?this.num+"":t+"";var n=90*Math.random()-45;if(o.x=this.img.x+n,o.y=this.img.y-80,e.addChild(o),egret.Tween.removeTweens(this.img),egret.Tween.get(this.img).to({y:this.img.y-10},20).to({y:this.img.y},20),egret.Tween.get(o).to({scaleX:1.2,scaleY:1.2,y:o.y-80},500).to({alpha:.5},200).call(function(){o.parent&&o.parent.removeChild(o)}),this.num>t)this.num-=t,this.txt.text=this.num+"";else{this.isRemoved=!0,e.world.removeBody(this.boxBody),this.img.parent&&this.img.parent.removeChild(this.img),this.txt.parent&&this.txt.parent.removeChild(this.txt);var i=2==this.type?1:this.type,a=movieMaster.getGif("boom_"+i),s=5==this.type?250:200;if(a.x=this.img.x-s/2,a.y=this.img.y-s/2,e.addChild(a),a.gotoAndPlay(1,1),a.addEventListener(egret.Event.COMPLETE,function(e){a.parent&&a.parent.removeChild(a)},this),e.conTimes.num++,e.conTimes.num>2){var l=new egret.BitmapText;l.font=RES.getRes("blue_text_fnt"),l.text="X"+e.conTimes.num,l.x=this.img.x+50,l.y=this.img.y-50,l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.scaleX=0,l.scaleY=0,e.addChild(l),egret.Tween.get(l).to({scaleX:1.5,scaleY:1.5},300).wait(800).to({alpha:0},200).call(function(){l.parent&&l.parent.removeChild(l)})}if(5==this.type){soundMaster.playSingleMusic("boom_sound");for(var d=e.adaptParams.itemWidth/e.factor,u=function(t,o){var n=e.gridArr[t],i=Math.floor(100*Math.abs(n.boxBody.position[0]-c.boxBody.position[0]))/100,a=Math.floor(100*Math.abs(n.boxBody.position[1]-c.boxBody.position[1]))/100;if(n.boxBody.id!=c.boxBody.id&&d>=i&&d>=a)if(3==n.type){if(!n.isRemoved){e.shootPoint.beeNum++;var s=n.boxBody.position[0];n.updateText(e,function(){var t=new beeCom;t.createBody(e,s),e.beeArr.push(t)})}}else 4==n.type||n.isRemoved||n.updateText(e,n.num,r)},c=this,h=0,p=e.gridArr.length;p>h;h++)u(h,p)}r&&r()}},e.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e+"_png");return t.texture=r,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t},e}();__reflect(gridCom.prototype,"gridCom"),window.gridCom=gridCom;var starCom=function(){function e(){this.type=4,this.isRemoved=!1,this.squareType=2,this.init()}return e.prototype.init=function(){this.img=this.createBitmapByName("img_lightning_01")},e.prototype.createBody=function(e,t,r){var o=new p2.Box({width:1.92,height:1.92});return o.collisionGroup=2,o.collisionMask=5,o.sensor=!0,this.boxBody=new p2.Body({mass:100,position:[e,t],type:p2.Body.KINEMATIC}),this.boxBody.addShape(o),this.boxBody.displays=[this.img],r.addChild(this.img),this.boxBody},e.prototype.updateText=function(e,t){void 0===t&&(t=null);var r=this;if(r.isRemoved=!0,!this.gif){var o=movieMaster.getGif("lightning");o.x=this.img.x-90,o.y=this.img.y-90,this.gif=o,o.addEventListener(egret.Event.COMPLETE,function(e){o.parent&&o.parent.removeChild(o)},this)}e.addChild(this.gif),this.gif.gotoAndPlay(1,1),t&&t()},e.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e+"_png");return t.texture=r,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t},e}();__reflect(starCom.prototype,"starCom"),window.starCom=starCom;var tweenButton=function(e){function t(){var t=e.call(this)||this;return t.osx=t.scaleX,t.osy=t.scaleY,t}return __extends(t,e),t.prototype.onTouchCancle=function(t){e.prototype.onTouchCancle.call(this,t);var r=egret.Tween.get(this);r.to({scaleX:this.osx,scaleY:this.osy},60)},t.prototype.onTouchBegin=function(t){e.prototype.onTouchBegin.call(this,t);var r=egret.Tween.get(this);r.to({scaleX:.8*this.osx,scaleY:.8*this.osy},60)},t.prototype.buttonReleased=function(){e.prototype.buttonReleased.call(this);var t=egret.Tween.get(this);t.to({scaleX:this.osx,scaleY:this.osy},60)},t}(eui.Button);__reflect(tweenButton.prototype,"tweenButton"),window.tweenButton=tweenButton;var AdMaster=function(){function e(){}return e.getInstance=function(){return e.shared||(e.shared=new e),e.shared},e.init=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(r){switch(r.label){case 0:return t=this,e.INIT_STATUS=1,[4,this.list()];case 1:return r.sent(),[2]}})})},e.list=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,ServiceMaster.post(ServiceMaster.getConfig,{},function(t){1===parseInt(t.code)&&t.data&&(2==t.data.edition_3&&(CallbackMaster.hasChecked=!0),void 0!==t.data.banner_id&&null!=t.data.banner_id&&t.data.banner_id.length>0&&(e.banner=t.data.banner_id,e.hasBanner=!0,e.randomCacheBannerAd()),void 0!==t.data.video_id&&null!=t.data.video_id&&t.data.video_id.length>0&&(e.video=t.data.video_id,e.hasVideo=!0,e.randomCacheVideoAd()),e.INIT_STATUS=2,t.data.share_title&&(CallbackMaster.share_title=t.data.share_title),t.data.share_img&&(CallbackMaster.share_img=t.data.share_img))},function(t){e.INIT_STATUS=3})];case 1:return t.sent(),[2]}})})},e.randomCacheVideoAd=function(){e.video&&(e.cacheVideoAd=platform.createRewardedVideoAd(e.video[Math.floor(Math.random()*e.video.length)]),e.cacheVideoAd.onError(function(t){console.log(1,t),e.noVideo=!0}))},e.randomCacheBannerAd=function(){e.banner&&(e.cacheBannerAd=platform.createBannerAd(e.banner[Math.floor(Math.random()*e.banner.length)],{}),e.cacheBannerAd.onError(function(e){console.log(e)}))},e.openVideoAd=function(t,r){void 0===t&&(t=null),void 0===r&&(r=null),e.cacheVideoAd&&(e.cacheVideoAd.show().then(function(){})["catch"](function(t){e.cacheVideoAd.load(),r(t)}),e.cacheVideoAd.onClose(t))},e.openBannerAd=function(t){void 0===t&&(t={});var r=setInterval(function(){e.INIT_STATUS>1&&(e._openBannerAd(t),clearInterval(r))},50)},e._openBannerAd=function(t){e.cacheBannerAd&&(e.cacheBannerAd.style.width=DeviceMaster.getX(t.width)||DeviceMaster.screenWidth,e.cacheBannerAd.style.left=DeviceMaster.getX(t.left)||0,e.cacheBannerAd.style.top=DeviceMaster.getY(t.top)||0,t.height&&(e.cacheBannerAd.style.height=DeviceMaster.getY(t.height)),e.cacheBannerAd.show(),e.cacheBannerAd.onResize(function(t){var r=t.height*DeviceMaster.screenWidth/t.width;e.cacheBannerAd.style.width=DeviceMaster.screenWidth,e.cacheBannerAd.style.top=DeviceMaster.screenHeight-r,DeviceMaster.stageHeight>1600&&(e.cacheBannerAd.style.top-=40)}))},e.closeBannerAd=function(){e.cacheBannerAd&&e.cacheBannerAd.hide()},e.useVideo=function(t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),e.cacheVideoAd)if(e.noVideo)platform.showModal({title:"温馨提示",content:"今日视频次数已经用完，请明日再来哦~"});else{var o=!0;e.openVideoAd(function(e){(e&&e.isEnded||void 0===e)&&o&&t&&t(),t=null,o=!1})}else r&&r()},e.banner=[],e.hasBanner=!1,e.video=[],e.hasVideo=!1,e.cacheVideoAd=null,e.haveMoreVideo=!0,e.cacheBannerAd=null,e.INIT_STATUS=0,e.closeSuccess=null,e.initClose=!1,e.noVideo=!1,e}();__reflect(AdMaster.prototype,"AdMaster"),window.AdMaster=AdMaster;var CallbackMaster=function(){function e(){}return e.init=function(){var t=Math.floor(Math.random()*e.share_title.length),r={query:"type=newUser&uid="+userDataMaster.getMyInfo.uid,title:e.share_title[t],imageUrl:e.share_img[t]};platform.onShareAppMessage(r),platform.onShow(function(t){var r=e.shareCount+1;if(0==e.shareCount){e.saveShareSuc=e.shareSuc;var o={title:"温馨提示",content:e.shareFailText,confirmText:"好的",showCancel:!1,success:function(t){t.confirm&&e.openShare(e.saveShareSuc,r)}};platform.showModal(o)}else if((new Date).getTime()-e.shareTime>3e3)e.shareSuc&&e.shareSuc(),e.saveShareSuc=null;else{e.saveShareSuc=e.shareSuc;var n={title:"温馨提示",content:"分享成功可以获得丰厚奖励",confirmText:"分享",success:function(t){t.confirm&&e.openShare(e.saveShareSuc,r)}};platform.showModal(n)}e.shareSuc=null,e.shareCount=-1}),platform.onHide(function(){soundMaster.soundChannel&&soundMaster.soundChannel.stop(),e.onHideFun&&e.onHideFun();var t={gold:userDataMaster.gold,level:userDataMaster.level,life:userDataMaster.life,closeDate:(new Date).getTime()-(6e5-1e3*userDataMaster.seconds),levelStar:userDataMaster.levelStar,dayShareLife:userDataMaster.dayShareLife,dayShareGold:userDataMaster.dayShareGold,tool:userDataMaster.tool,dayGift:userDataMaster.dayGift,bulletIndex:userDataMaster.bulletIndex,bulletSateArr:userDataMaster.bulletSateArr,dayFreeLife:userDataMaster.dayFreeLife},r={uid:userDataMaster.getMyInfo.uid,info:JSON.stringify(t)};ServiceMaster.post(ServiceMaster.setGameData,r,function(e){1==e.code&&e.data})})},e.openShare=function(t,r,o,n){if(void 0===t&&(t=null),void 0===r&&(r=0),void 0===o&&(o=""),void 0===n&&(n=0),e.hasChecked){var i=Math.floor(Math.random()*e.share_title.length),a={title:e.share_title[i],imageUrl:e.share_img[i],query:"uid="+userDataMaster.getMyInfo.uid+o};platform.shareAppMessage(a),e.shareTime=r>=0?(new Date).getTime():0,e.shareCount=r,e.shareSuc=t}},e.openHide=function(t){void 0===t&&(t=null),e.onHideFun=t},e.recommandClick=function(e,t){void 0===e&&(e=1);var r=userDataMaster.getMyInfo.uid,o={id:t.id,uid:r,appid:t.appid,type:e,module_id:t.module_id,module_ext_id:t.module_ext_id};ServiceMaster.post(ServiceMaster.gameClick,o,function(e){1==e.code&&e.data})},e.shareSuc=null,e.shareTime=0,e.shareCount=-1,e.onHideFun=null,e.hasChecked=!1,e.saveShareSuc=null,e.shareFailText="好友信号连接失败，再试试吧",e.share_title=[],e.share_img=[],e}();__reflect(CallbackMaster.prototype,"CallbackMaster");var DeviceMaster=function(){function e(){}return e.init=function(t,r){void 0===t&&(t=750),void 0===r&&(r=1334),e.stageWidth=t,e.stageHeight=r,e.SYSTEM_INFO=platform.getSystemInfoSync(),e.model=e.SYSTEM_INFO.model,e.system=e.SYSTEM_INFO.system,e.screenWidth=e.SYSTEM_INFO.screenWidth,e.screenHeight=e.SYSTEM_INFO.screenHeight,e.scaleWidth=e.screenWidth/e.stageWidth,e.scaleHeight=e.screenHeight/e.stageHeight,e.windowWidth=2*e.SYSTEM_INFO.windowWidth,e.windowHeight=2*e.SYSTEM_INFO.windowHeight},e.getX=function(t){return void 0===t&&(t=0),t*e.scaleWidth},e.getY=function(t){return void 0===t&&(t=0),t*e.scaleHeight},e.screenWidth=750,e.screenHeight=1334,e.windowWidth=750,e.windowHeight=1334,e.stageWidth=750,e.stageHeight=1334,e.scaleWidth=1,e.scaleHeight=1,e}();__reflect(DeviceMaster.prototype,"DeviceMaster"),window.DeviceMaster=DeviceMaster;var movieMaster=function(){function e(){}return e.init=function(){var t=RES.getRes("boom_gif_json"),r=RES.getRes("boom_gif_png");e.mcFactory=new egret.MovieClipDataFactory(t,r);var o=RES.getRes("boom_gif_2_json"),n=RES.getRes("boom_gif_2_png");e.mcFactory2=new egret.MovieClipDataFactory(o,n);var i=RES.getRes("boom_gif_3_json"),a=RES.getRes("boom_gif_3_png");e.mcFactory3=new egret.MovieClipDataFactory(i,a);var s=RES.getRes("glass_gif_json"),l=RES.getRes("glass_gif_png");e.mcFactory4=new egret.MovieClipDataFactory(s,l);var d=RES.getRes("level_up_json"),u=RES.getRes("level_up_png");e.mcFactory5=new egret.MovieClipDataFactory(d,u)},e.getGif=function(t){var r;return r=-1!=e.factory2.indexOf(t)?new egret.MovieClip(e.mcFactory2.generateMovieClipData(t)):-1!=e.factory3.indexOf(t)?new egret.MovieClip(e.mcFactory3.generateMovieClipData(t)):-1!=e.factory4.indexOf(t)?new egret.MovieClip(e.mcFactory4.generateMovieClipData(t)):-1!=e.factory5.indexOf(t)?new egret.MovieClip(e.mcFactory5.generateMovieClipData(t)):new egret.MovieClip(e.mcFactory.generateMovieClipData(t))},e.factory2=["cartridge"],e.factory3=["gif_streamer"],e.factory4=["glass"],e.factory5=["through"],e}();__reflect(movieMaster.prototype,"movieMaster"),window.movieMaster=movieMaster;var sceneMaster=function(){function e(){}return e.init=function(t){e.stage=t,e.stageHeight=t.stageHeight;var r=new eui.Rect(t.stageWidth,t.stageHeight,787200);r.alpha=.85,e.modalBg=r;var o=new eui.Rect(t.stageWidth,t.stageHeight,787200);o.alpha=.85,e.littleBg=o},e.changeScene=function(t){e.modal&&e.modal.parent&&e.modal.parent.removeChild(e.modal),e.scene&&e.scene.parent&&e.stage.removeChild(e.scene),e.scene=t,e.stage.addChild(t),e.modal=null,e.littleModal=null},e.openModal=function(t,r){void 0===r&&(r=!0),e.modal&&(e.scene.removeChild(e.modal),e.modal=null,e.littleModal=null),e.modal=t,r?(e.scene.addChild(e.modalBg),t.scaleX=0,t.scaleY=0,e.scene.addChild(t),setTimeout(function(){t.x=375,t.y=t.height/2,1334!=t.height&&(t.y+=200),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,egret.Tween.get(t).to({scaleX:1,scaleY:1},500,egret.Ease.backOut)},50)):e.scene.addChild(t)},e.closeModal=function(){e.modal&&egret.Tween.get(e.modal).to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){e.scene.removeChild(e.modal),e.modalBg.parent&&e.scene.removeChild(e.modalBg),e.modal=null}),e.closeLittleModal()},e.openLittleModal=function(t,r,o){void 0===r&&(r=!0),void 0===o&&(o=300),e.littleModal&&e.scene.removeChild(e.littleModal),r&&e.scene.addChild(e.littleBg),e.littleModal=t,t.scaleX=0,t.scaleY=0,e.scene.addChild(t),setTimeout(function(){t.x=375,t.y=t.height/2+o,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,egret.Tween.get(t).to({scaleX:1,scaleY:1},500,egret.Ease.backOut)},50)},e.closeLittleModal=function(){e.littleModal&&(e.scene.removeChild(e.littleModal),e.littleModal=null,e.littleBg.parent&&e.scene.removeChild(e.littleBg))},e.stageHeight=1334,e}();__reflect(sceneMaster.prototype,"sceneMaster");var ServiceMaster=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.objSort=function(e){for(var t=Object.keys(e).sort(),r={},o=0;o<t.length;o++)r[t[o]]=e[t[o]];return r},e.createToken=function(t){"undefined"!=typeof t.token&&delete t.token;var r=e.objSort(t),o="";for(var n in r)o+=o?"&":"",o+=n+"="+r[n];return o+="!@#$%^&*",(new md5).hex_md5(o)},e.request=function(e,t,r,o,n,i){void 0===t&&(t="POST"),void 0===r&&(r={}),void 0===o&&(o=null),void 0===n&&(n=null),void 0===i&&(i=null);var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT,a.open(e,egret.HttpMethod[t]),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),r.token=this.createToken(r),a.send(this.obj2str(r,!0)),a.addEventListener(egret.Event.COMPLETE,function(){o&&o(JSON.parse(a.response))},this),n&&a.addEventListener(egret.IOErrorEvent.IO_ERROR,n,this),i&&a.addEventListener(egret.ProgressEvent.PROGRESS,i,this)},e.post=function(t,r,o,n,i){void 0===r&&(r={}),void 0===o&&(o=null),void 0===n&&(n=null),void 0===i&&(i=null),e.request(e.DOMAIN+t,e.METHOD_POST,r,o,n,i)},e.get=function(t,r,o,n,i){void 0===r&&(r={}),void 0===o&&(o=null),void 0===n&&(n=null),void 0===i&&(i=null),e.request(e.DOMAIN+t,e.METHOD_GET,r,o,n,i)},e.obj2str=function(e,t){void 0===t&&(t=!1);var r="";for(var o in e)r+=!t||"encryptedData"!=o&&"iv"!=o?"&"+o+"="+e[o]:"&"+o+"="+encodeURI(e[o]).replace(/\+/g,"%2B");return r.substring(1)},e.DOMAIN="https://newbox.0e3.cn/gplants",e.METHOD_POST="POST",e.METHOD_GET="GET",e.logins="/user/logins",e.updateUser="/user/updateUser",e.getGameList="/other/getGameList",e.getConfig="/other/getConfig",e.getScore="/user/getScore",e.rank_world="/user/rank_world",e.gameClick="/other/gameClick",e.getGameData="/user/getGameData",e.setGameData="/user/setGameData",e}();__reflect(ServiceMaster.prototype,"ServiceMaster"),window.ServiceMaster=ServiceMaster;var soundMaster=function(){function e(){}return e.init=function(){RES.getResByUrl("https://lixi.h5.app81.com/minigame/game_lixi/shooting/bg.mp3",function(t){e.bg_sound=t,e.playBgMusic()}),RES.getResByUrl("https://lixi.h5.app81.com/minigame/game_lixi/shooting/boom.mp3",function(t){e.boom_sound=t}),RES.getResByUrl("https://lixi.h5.app81.com/minigame/game_lixi/shooting/hit.mp3",function(t){e.hit_sound=t})},e.playBgMusic=function(){e.isMusic&&setInterval(function(){e.bg_sound.play(0,1)},5e3)},e.playSingleMusic=function(t){e[t]&&e.isMusic&&e[t].play(0,1)},Object.defineProperty(e,"isMusic",{get:function(){return e.music
},set:function(t){t?e.music=!0:e.music=!1},enumerable:!0,configurable:!0}),e.music=!0,e.musicStart=0,e.pauseTime=0,e}();__reflect(soundMaster.prototype,"soundMaster");var userDataMaster=function(){function e(){}return e.getInstance=function(){return e.shared||(e.shared=new e),e.shared},e.init=function(){var t=[e.gold,e.life,e.level,e.bulletIndex,e.tool,e.myInfo];e.myCollection=new eui.ArrayCollection(t),e.login(),e.getRecommand()},e.getGameData=function(t){0!=t&&ServiceMaster.post(ServiceMaster.getGameData,{uid:t},function(t){if(1==t.code&&t.data){var r=t.data;if(r.info.length>0){var o=JSON.parse(r.info);if(o.gold&&(e.gold=o.gold),o.life>=0&&(e.life=o.life),o.level&&(e.level=o.level),o.closeDate&&(e.closeDate=o.closeDate,o.life<5)){var n=o.closeDate,i=((new Date).getTime()-n)/1e3/15/60,a=o.life+Math.floor(i);if(a>=5)e.myLife=o.life>5?o.life:5;else{e.life=a,e.myCollection.replaceItemAt(a,1);var s=Math.floor(15*(i-Math.floor(i))*60);e.updateTime(600-s)}}o.levelStar&&(e.levelStar=o.levelStar),o.dayShareLife&&(e.dayShareLife=o.dayShareLife,e.todayShareLife),o.dayShareGold&&(e.dayShareGold=o.dayShareGold,e.todayShareGold),o.dayGift&&(e.dayGift=o.dayGift,e.todayGift),o.tool&&(e.tool=o.tool),o.bulletSateArr&&(e.bulletSateArr=o.bulletSateArr),o.bulletIndex&&(e.bulletIndex=o.bulletIndex),o.dayFreeLife&&(e.dayFreeLife=o.dayFreeLife)}e.getDataSuccess=!0}})},e.getRecommand=function(){ServiceMaster.post(ServiceMaster.getGameList,{},function(t){1==t.code&&t.data&&(e.recommand=t.data)})},Object.defineProperty(e,"myGold",{set:function(t){e.gold=t,e.myCollection.replaceItemAt(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"myLife",{set:function(t){e.life=t,e.myCollection.replaceItemAt(t,1),5>t&&!e.terval&&(e.seconds=600,e.updateTime())},enumerable:!0,configurable:!0}),Object.defineProperty(e,"myLevel",{set:function(t){e.level=t,e.myCollection.replaceItemAt(t,2)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"myBulleIndex",{set:function(t){e.bulletIndex=t,e.myCollection.replaceItemAt(t,3)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"myTool",{set:function(t){e.tool=t,e.myCollection.replaceItemAt(t,4)},enumerable:!0,configurable:!0}),e.updateTime=function(t){void 0===t&&(t=600),clearInterval(e.terval),e.seconds=600,e.terval=setInterval(function(){t--,e.seconds=t,0>=t&&(clearInterval(e.terval),e.terval=null,e.life<5&&(e.myLife=e.life+1))},1e3)},Object.defineProperty(e,"getMyInfo",{get:function(){return e.myInfo},set:function(t){e.myInfo=t,e.myCollection.replaceItemAt(t,5)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"todayShareLife",{get:function(){if(e.dayShareLife.day==e.getToday()){if(e.dayShareLife.num>=5)return!1}else e.dayShareLife={day:e.getToday(),num:0};return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"todayShareGold",{get:function(){if(e.dayShareGold.day==e.getToday()){if(e.dayShareGold.num>=2)return!1}else e.dayShareGold={day:e.getToday(),num:0};return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"todayGift",{get:function(){if(e.dayGift.day==e.getToday()){if(e.dayGift.num>=6)return!1}else e.dayGift={day:e.getToday(),num:0};return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"todayFreeLife",{get:function(){return e.dayFreeLife.day==e.getToday()||(e.dayFreeLife={day:e.getToday(),num:0}),!0},enumerable:!0,configurable:!0}),e.createLoginBtn=function(t,r,o,n,i){return void 0===i&&(i=null),__awaiter(this,void 0,void 0,function(){var a,s,l;return __generator(this,function(d){switch(d.label){case 0:return a=this,s=DeviceMaster.screenWidth/750,t*=s,r*=s,o*=s,n*=s,l=e,[4,platform.createUserInfoButton({type:"image",image:"../../resource/assets/imgData/img_yxbj.png",style:{left:t,top:r,width:o,height:n,lineHeight:40,backgroundColor:"#ff0000",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}})];case 1:return l.userInfoBtn=d.sent(),e.userInfoBtn.onTap(function(t){e.updateUser(t,i)}),[2]}})})},e.updateUser=function(t,r){return void 0===t&&(t=null),void 0===r&&(r=null),__awaiter(this,void 0,void 0,function(){var o,n;return __generator(this,function(i){return o=t.userInfo,e.myInfo.nickName=o.nickName,e.myInfo.avatarUrl=o.avatarUrl,e.getMyInfo=e.myInfo,n={uid:e.getMyInfo.uid,nickName:o.nickName,gender:e.myInfo.gender,avatarUrl:o.avatarUrl},ServiceMaster.post(ServiceMaster.updateUser,n,function(t){1===parseInt(t.code)&&t.data&&(e.userInfoBtn&&e.userInfoBtn.destroy(),e.loginCallback&&e.loginCallback(),e.loginCallback=null,r&&r())}),[2]})})},e.login=function(){return __awaiter(this,void 0,void 0,function(){var t,r;return __generator(this,function(o){switch(o.label){case 0:return[4,platform.login()];case 1:return t=o.sent(),r={code:t.code},e.shareUid>0&&(r.pid=e.shareUid),e.requestTimes++,ServiceMaster.post(ServiceMaster.logins,r,function(t){1===parseInt(t.code)&&t.data&&(e.getMyInfo=t.data,platform.openDataContext.postMessage({type:"openid",openid:t.data.openId}),e.getGameData(t.data.uid),e.requestTimes=5)}),setTimeout(function(){e.requestTimes<5&&e.login()},5e3),[2]}})})},e.getToday=function(){var e=new Date,t=e.getMonth()+1>9?e.getMonth()+1+"":"0"+(e.getMonth()+1),r=e.getDate()>9?e.getDate()+"":"0"+e.getDate();return e.getFullYear()+"-"+t+"-"+r},e.myInfo={uid:0,openId:"",is_new_user:!0,nickName:"",avatarUrl:"",gender:0},e.gold=0,e.life=5,e.level=0,e.closeDate=0,e.seconds=0,e.terval=null,e.levelStar=[],e.bulletIndex=0,e.tool={bullet:{level:5,unlock:!1,num:1},glass:{level:1,unlock:!1,num:1},hammer:{level:2,unlock:!1,num:1},hat:{level:10,unlock:!1,num:1},lamp:{level:15,unlock:!1,num:1}},e.bulletArr=[{id:0,img:"img_bullet_a2",title:"刺刺炮",price:100,powerImg:1,txt:"",target:{}},{id:1,img:"img_bullet_b3",title:"蘑菇炮",price:500,powerImg:3,txt:"对炸弹方块威力+2",target:{type_5:2}},{id:2,img:"img_bullet_c3",title:"大头炮",price:1e3,powerImg:3,txt:"对移动方块威力+2",target:{type_6:2}},{id:3,img:"img_bullet_d3",title:"小南瓜",price:2e3,powerImg:2,txt:"对普通方块威力+1",target:{type_1:1,type_2:1}},{id:4,img:"img_bullet_e3",title:"包菜君",price:3e3,powerImg:2,txt:"对所有方块威力+1",target:{type_1:1,type_2:1,type_5:1,type_6:1}}],e.bulletSateArr=[1,0,0,0,0],e.levelArr=[],e.shareUid=0,e.requestTimes=0,e.dayShareLife={day:"",num:0},e.dayShareGold={day:"",num:0},e.dayGift={day:"",num:0},e.dayFreeLife={day:"",num:0},e.loginCallback=null,e.getDataSuccess=!1,e}();__reflect(userDataMaster.prototype,"userDataMaster"),window.userDataMaster=userDataMaster;var dangerModal=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){var e=this;AdMaster.cacheBannerAd&&AdMaster.openBannerAd({width:700,height:300}),egret.Tween.get(e.light,{loop:!0}).to({rotation:360},3e3),e.useBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.useFun,this),e.ignoreBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.ignoreFun,this),setTimeout(function(){e.ignoreBtn.visible=!0},3e3)},t.prototype.useFun=function(){egret.Tween.removeTweens(this.light)},t.prototype.ignoreFun=function(){AdMaster.closeBannerAd(),egret.Tween.removeTweens(this.light),sceneMaster.closeModal()},t}(eui.Component);__reflect(dangerModal.prototype,"dangerModal",["eui.UIComponent","egret.DisplayObject"]);var getLifeModal=function(e){function t(){var t=e.call(this)||this;return t.shareCount=0,t}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.videoBtn?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this;AdMaster.cacheBannerAd&&AdMaster.openBannerAd({width:700,height:300});var t=setInterval(function(){userDataMaster.life>=5&&(clearInterval(t),userDataMaster.seconds=0),e.getFormat(userDataMaster.seconds)},1e3);e.shareTimes.text="("+userDataMaster.dayShareLife.num+"/5)",this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeFun,this),this.videoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.videoFun,this),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareFun,this)},t.prototype.getFormat=function(e){for(var t=Math.floor(e/60),r=10>t?"0"+t:t,o=e%60,n=10>o?"0"+o:o+"",i=r+":"+n,a=0,s=i.length;s>a;a++)this["timeText_"+a].text=i[a]},t.prototype.closeFun=function(){AdMaster.closeBannerAd(),sceneMaster.closeModal()},t.prototype.videoFun=function(){function e(){userDataMaster.myLife=userDataMaster.life+1,sceneMaster.openLittleModal(new getSuccess("img_gift_01_png",""))}AdMaster.useVideo(function(){e()},function(){platform.showModal({title:"温馨提示",content:"视频奖励次数已达上限"})})},t.prototype.shareFun=function(){var e=this;userDataMaster.todayShareLife?(CallbackMaster.openShare(function(){userDataMaster.dayShareLife.num++,userDataMaster.myLife=userDataMaster.life+1,e.shareTimes.text="("+userDataMaster.dayShareLife.num+"/5)",sceneMaster.openLittleModal(new getSuccess("img_gift_01_png",""))},e.shareCount),e.shareCount++):platform.showModal({title:"温馨提示",content:"今日获取次数已用完，请明日再来"})},t}(eui.Component);__reflect(getLifeModal.prototype,"getLifeModal",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(e){function t(t){void 0===t&&(t=1334);var r=e.call(this)||this;return r.stageHeight=1334,r.stageHeight=t,r.createView(),r}return __extends(t,e),t.prototype.createView=function(){var e=this.stageHeight-1334,t=this.createBitmapByName("img_bg_loading_jpg");t.height=this.stageHeight,this.addChild(t);var r=this.createBitmapByName("img_text_08_png");r.x=(750-r.width)/2,r.y=140,this.addChild(r);var o=this.createBitmapByName("img_bg_01_png");o.x=66,o.y=1180+e,this.addChild(o),this.pro=this.createBitmapByName("img_bg_02_png"),this.pro.width=0,this.pro.x=75,this.pro.y=1189+e,this.addChild(this.pro),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=1150+e,this.textField.x=54,this.textField.width=100,this.textField.height=200,this.textField.size=30,this.textField.textColor=16777215,this.textField.bold=!0;var n=new egret.TextField;this.addChild(n),n.y=1240+e,n.text="抵制不良游戏  拒绝盗版游戏  注意自我保护  谨防受骗上当",n.width=750,n.size=22,n.textColor=3114031,n.textAlign="center";var i=new egret.TextField;this.addChild(i),i.y=1280+e,i.text="适度游戏益脑  沉迷游戏伤身  合理安排时间  享受健康生活",i.width=750,i.size=22,i.textColor=3114031,i.textAlign="center"},t.prototype.onProgress=function(e,t){var r=Math.floor(e/t*100);this.pro.width=600*r/100,this.textField.text=r+"%",this.textField.x=54+this.pro.width},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e);return t.texture=r,t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var giftModal=function(e){function t(){var t=e.call(this)||this;return t.terval=null,t.current=0,t.speed=1e3,t.choosing=!1,t.canTap=!0,t.shareCount=0,t.dataArr=[{id:0,name:"img_gift_05_png",num:1,type:"bullet"},{id:1,name:"img_gift_02_png",num:30,type:"gold"},{id:2,name:"img_gift_05_png",num:1,type:"bullet"},{id:3,name:"img_gift_04_png",num:1,type:"glass"},{id:4,name:"img_gift_01_png",num:2,type:"life"},{id:5,name:"img_gift_02_png",num:20,type:"gold"},{id:6,name:"img_gift_01_png",num:1,type:"life"},{id:7,name:"img_gift_03_png",num:10,type:"gold"}],t}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){var e=this;e.bgImg.height=e.stage.stageHeight,egret.Tween.get(e.getBtn,{loop:!0}).to({scaleX:1.2,scaleY:1.2},1e3).to({scaleX:1,scaleY:1},1e3),userDataMaster.dayGift.num>0&&(e.getBtn.texture=RES.getRes("btn_lottery_02_png")),e.getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.getFun,this),e.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.closeFun,this),e.terval=setInterval(function(){e.timer(e)},1e3)},t.prototype.timer=function(e){if(e["bg_"+e.current].texture=RES.getRes("img_bg_lottery_01_png"),e.current=e.current<7?e.current+1:0,e["bg_"+e.current].texture=RES.getRes("img_bg_lottery_02_png"),!e.canTap&&e.speed>=1e3){e.choosing=!1;var t=Math.floor(8*Math.random()*1e3)+5;setTimeout(function(){if(!e.canTap){clearInterval(e.terval);var t=e.dataArr[e.current];switch(t.type){case"glass":case"bullet":var r=userDataMaster.tool;r[t.type].num+=t.num,userDataMaster.myTool=r;break;case"gold":var o=userDataMaster.gold;o+=t.num,userDataMaster.myGold=o;break;case"life":var n=userDataMaster.life;n+=t.num,userDataMaster.myLife=n}0==userDataMaster.dayGift.num?userDataMaster.dayGift.num++:"",e.getBtn.texture=RES.getRes("btn_lottery_02_png"),sceneMaster.openLittleModal(new getSuccess(t.name,"X"+t.num)),e.canTap=!0}},t)}e.choosing&&(e.speed+=100,clearInterval(e.terval),e.terval=setInterval(function(){e.timer(e)},e.speed))},t.prototype.getFun=function(){function e(){t.canTap=!1,t.speed=50,userDataMaster.dayGift.num++,clearInterval(t.terval),t.terval=setInterval(function(){t.timer(t)},t.speed),setTimeout(function(){t.choosing=!0},3e3)}var t=this;if(t.canTap){if(!userDataMaster.todayGift)return void platform.showModal({title:"温馨提示",content:"今日抽奖次数已用完，请明日再来"});egret.Tween.removeTweens(t.getBtn),egret.Tween.get(t.getBtn).to({scaleX:.8,scaleY:.8},60).to({scaleX:1,scaleY:1},60),0==userDataMaster.dayGift.num?e():userDataMaster.dayGift.num<3?(CallbackMaster.openShare(function(){e()},t.shareCount),t.shareCount++):AdMaster.useVideo(function(){e()},function(){CallbackMaster.openShare(function(){e()},t.shareCount),t.shareCount++})}},t.prototype.closeFun=function(){egret.Tween.removeTweens(this.getBtn),sceneMaster.closeModal()},t}(eui.Component);__reflect(giftModal.prototype,"giftModal",["eui.UIComponent","egret.DisplayObject"]);var levelItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){},t.prototype.jumpFun=function(){sceneMaster.openModal(new playBefore(this.data.level))},t.prototype.dataChanged=function(){var e=(this.data.level+2)%t.point.length+1;if(this.map.texture=RES.getRes("img_map_0"+e+"_png"),this.bodyGroup.x=t.point[e-1].x,this.bodyGroup.y=t.point[e-1].y,this.levelText.text=this.data.level+"",this.star_1.visible=!0,this.star_2.visible=!0,this.star_3.visible=!0,this.bodyGroup.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.bodyGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpFun,this),this.data.level<=userDataMaster.levelStar.length){this.bgImg.texture=RES.getRes("img_wood_01_png");for(var r=1;r<=userDataMaster.levelStar[this.data.level-1];r++)this["star_"+r].texture=RES.getRes("img_star_b1_png")}else this.data.level==userDataMaster.levelStar.length+1?this.bgImg.texture=RES.getRes("img_wood_01_png"):(this.star_1.visible=!1,this.star_2.visible=!1,this.star_3.visible=!1,this.bodyGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpFun,this));if(this.data.level>userDataMaster.levelArr.length){this.levelText.text="";var o=new eui.Image(RES.getRes("img_expect_png"));o.horizontalCenter=0,o.y=20,this.bodyGroup.addChild(o),this.bodyGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.jumpFun,this)}this.cacheAsBitmap=!0},t.point=[{x:230,y:-30},{x:142,y:0},{x:262,y:-6},{x:422,y:-40},{x:480,y:0},{x:255,y:-30},{x:120,y:-30},{x:260,y:0},{x:390,y:-26}],t}(eui.ItemRenderer);__reflect(levelItem.prototype,"levelItem",["eui.UIComponent","egret.DisplayObject"]),window.levelItem=levelItem;var levelUpModal=function(e){function t(t,r){var o=e.call(this)||this;return o.shareCount=0,o.level=t,o.info=r,o}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.videoBtn?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){AdMaster.cacheBannerAd&&AdMaster.openBannerAd({width:700,height:300}),this.scoreText.text=this.info.score+"",this.levelText.text="第"+this.level+"关",this.goldText.text="X"+this.info.gold,this.level>userDataMaster.levelStar.length?(userDataMaster.levelStar.push(this.info.star),userDataMaster.myLevel=this.level):this.info.star>userDataMaster.levelStar[this.level-1]&&(userDataMaster.levelStar[this.level-1]=this.info.star);var e=this;e.gif=movieMaster.getGif("through"),e.gif.y=-300,e.addChildAt(e.gif,0),e.gif.gotoAndPlay(1,-1);for(var t=function(t){setTimeout(function(){e["star_"+t].texture=RES.getRes("img_star_a1_png")},300*t)},r=1;r<=this.info.star;r++)t(r);var o={uid:userDataMaster.myInfo.uid,level:e.level,score:e.info.score,star:e.info.star};ServiceMaster.post(ServiceMaster.getScore,o,function(e){1===parseInt(e.code)&&e.data}),platform.openDataContext.postMessage({type:"updateScore",score:e.info.score,level:e.level,star:e.info.star}),this.videoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.videoFun,this),this.getBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.getFun(e.info.gold)},this)},t.prototype.videoFun=function(){var e=this;AdMaster.useVideo(function(){e.getFun(2*e.info.gold)},function(){CallbackMaster.openShare(function(){e.getFun(2*e.info.gold)},e.shareCount),e.shareCount++})},t.prototype.getFun=function(e){var t=this;AdMaster.closeBannerAd(),userDataMaster.myGold=userDataMaster.gold+e,t.gif.stop(),egret.Tween.removeAllTweens(),sceneMaster.changeScene(new startScene),setTimeout(function(){sceneMaster.openModal(new getSuccess("img_diamond_big_png","X"+e))},50)},t}(eui.Component);__reflect(levelUpModal.prototype,"levelUpModal",["eui.UIComponent","egret.DisplayObject"]);var moreComponent=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){for(var e=userDataMaster.recommand[1].games,t=0;t<e.length;t++)e[t].color=6303749;this.sourceArr=new eui.ArrayCollection(e),this.dataGroup=new eui.DataGroup,this.dataGroup.dataProvider=this.sourceArr,this.dataGroup.percentWidth=400,this.dataGroup.percentHeight=170*this.sourceArr.length,this.content.height=170*this.sourceArr.length,this.dataGroup.useVirtualLayout=!0;var r=new eui.TileLayout;r.horizontalGap=0,r.verticalGap=15,this.dataGroup.layout=r,this.content.addChild(this.dataGroup),this.dataGroup.itemRenderer=moreItem,this.changeArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changePosition,this),this.tipImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changePosition,this)},t.prototype.changePosition=function(){var e=this;1==this.tipImg.visible&&(this.tipImg.visible=!1),-465==this.container.x?egret.Tween.get(this.container).to({x:0},500).call(function(){e.changeArea.texture=RES.getRes("btn_more_game_turn_png")}):egret.Tween.get(this.container).to({x:-465},500).call(function(){e.changeArea.texture=RES.getRes("btn_more_game_png")})},t}(eui.Component);__reflect(moreComponent.prototype,"moreComponent",["eui.UIComponent","egret.DisplayObject"]),window.moreComponent=moreComponent;var moreItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){var e=this;this.image.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){CallbackMaster.recommandClick(1,e.data);var t=2;platform.navigateToMiniProgram({appId:e.data.appid,path:e.data.path,extraData:{},success:function(e){},fail:function(e){t=3},complete:function(){CallbackMaster.recommandClick(t,e.data)}})},this)},t.prototype.dataChanged=function(){this.title.text=this.data.name,this.image.source=this.data.image||"",this.data.color&&(this.title.textColor=this.data.color)},t}(eui.ItemRenderer);__reflect(moreItem.prototype,"moreItem",["eui.UIComponent","egret.DisplayObject"]),window.moreItem=moreItem;var myShop=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.goldGroup?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this;e.goldNum.text=userDataMaster.gold+"",e.scroller.height=e.stage.stageHeight-150,e.sourceArr=new eui.ArrayCollection(userDataMaster.bulletArr),e.dataGroup=new eui.DataGroup,e.dataGroup.dataProvider=e.sourceArr,e.dataGroup.useVirtualLayout=!0;var t=new eui.VerticalLayout;t.gap=-20,e.dataGroup.layout=t,e.dataGroup.itemRenderer=shopItem,e.contentGroup.height=293*userDataMaster.bulletArr.length,e.contentGroup.addChild(e.dataGroup),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeFun,this),this.goldGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldGroupFun,this),userDataMaster.myCollection.addEventListener(eui.CollectionEvent.COLLECTION_CHANGE,this.collectionChangeHandler,this)},t.prototype.collectionChangeHandler=function(e){var t=this;userDataMaster.bulletArr[userDataMaster.bulletIndex];t.goldNum.text=userDataMaster.gold+"",t.sourceArr.refresh()},t.prototype.closeFun=function(){sceneMaster.closeModal()},t.prototype.goldGroupFun=function(){},t}(eui.Component);__reflect(myShop.prototype,"myShop",["eui.UIComponent","egret.DisplayObject"]);var playBefore=function(e){function t(t){var r=e.call(this)||this;return r.shareCount_1=0,r.shareCount_2=0,r.choose={glass:!1,bullet:!1},r.level=t,r}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.startBtn?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this;AdMaster.cacheBannerAd&&AdMaster.openBannerAd({width:700,height:300});var t=0;if(5==this.level&&4==userDataMaster.level?(t=6,e.guide.visible=!0,e.guide.x=400,e.txt_1.text="点击试试新的道具",e.txt_1.text="超级弹药筒"):1==this.level&&0==userDataMaster.level?(t=5,e.guide.visible=!0):(e.removeChild(e.guide),this.level<=userDataMaster.level?(e.startBtn.parent.removeChild(e.startBtn),e.videoBtn.texture=RES.getRes("btn_start_04_png")):userDataMaster.dayFreeLife.num>=3&&(e.videoBtn.texture=RES.getRes("btn_before_02_png"))),egret.Tween.get(e.glassImg,{loop:!0}).to({scaleX:1.2,scaleY:1.2},1e3).to({scaleX:1,scaleY:1},1e3),this.level>=5?(userDataMaster.tool.bullet.num<=0&&(e.bulletNum.visible=!1,e.bulletAdd.visible=!0),egret.Tween.get(e.bulletImg,{loop:!0}).to({scaleX:1.2,scaleY:1.2},1e3).to({scaleX:1,scaleY:1},1e3),e.bullet.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseFun("bullet")},this)):(e.glass.x=(e.width-e.glass.width)/2,e.bullet.parent.removeChild(e.bullet)),e.startBtn.parent&&e.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.startFun,this),e.videoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.videoFun,this),e.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.closeFun,this),e.glass.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.chooseFun("glass")},this),e.guide.parent){var r=!1;5!=t||userDataMaster.tool.glass.unlock?6!=t||userDataMaster.tool.bullet.unlock||(userDataMaster.tool.bullet.unlock=!0,r=!0):(userDataMaster.tool.glass.unlock=!0,r=!0),r&&(e.guideBg=new eui.Rect(e.width+100,e.height,787200),e.guideBg.horitionalCenter=0,e.guideBg.alpha=.5,e.addChildAt(e.guideBg,t),egret.Tween.get(e.guide).wait(1e3).to({scaleX:1,scaleY:1},1e3,egret.Ease.elasticOut))}userDataMaster.tool.glass.num<=0&&(e.glassNum.visible=!1,e.glassAdd.visible=!0),e.titleText.text="第"+this.level+"关"},t.prototype.chooseFun=function(e){function t(){var t=userDataMaster.tool;t[e].num++,userDataMaster.myTool=t,r[e+"Add"].visible=!1,r[e+"Num"].visible=!0,r[e+"Num"].text="X"+t[e].num}var r=this;return!r.choose[e]&&userDataMaster.tool[e].num<=0?void AdMaster.useVideo(function(){t()},function(){CallbackMaster.openShare(function(){t()},r.shareCount_1),r.shareCount_1++}):void(r.guideBg&&r.guideBg.parent&&r.choose[e]||(r.choose[e]=!r.choose[e],r[e+"Choose"].visible=r.choose[e],r[e+"Light"].visible=r.choose[e],r.choose[e]?egret.Tween.get(r[e+"Light"],{loop:!0}).to({rotation:360},3e3):egret.Tween.removeTweens(r[e+"Light"]),r[e+"Num"].visible=!r.choose[e],r.guideBg&&r.guideBg.parent&&(r.bullet.parent?(r.txt_1.text="里面多藏了5颗弹药",r.txt_2.text="助力开局",r.bullet.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.chooseFun("bullet")},this)):(r.txt_1.text="你将可以看清",r.txt_2.text="发射后的拐弯路线"),setTimeout(function(){r.guideBg.parent&&r.guideBg.parent.removeChild(r.guideBg)},2e3))))},Object.defineProperty(t.prototype,"factor",{get:function(){return 0},set:function(e){this.img.x=(1-e)*(1-e)*-150+2*e*(1-e)*100+e*e*150,this.img.y=(1-e)*(1-e)*-200+2*e*(1-e)*200+e*e*550,this.img.scaleX=1-e,this.img.scaleY=1-e},enumerable:!0,configurable:!0}),t.prototype.startFun=function(e){void 0===e&&(e=!0);var t=this,r=0;if(e){if(userDataMaster.life<=0)return console.log("体力不足"),void platform.showModal({title:"温馨提示",content:"您的体力不足",success:function(e){e.confirm&&(AdMaster.closeBannerAd(),egret.Tween.removeAllTweens(),sceneMaster.changeScene(new startScene),sceneMaster.openModal(new getLifeModal))}});r=500;var o=new eui.Image(RES.getRes("img_strength_01_png"));o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.y=-200,o.x=-100,t.addChild(o),t.img=o,egret.Tween.get(t).to({factor:1},r),userDataMaster.myLife=userDataMaster.life-1}setTimeout(function(){for(var e in t.choose)t.choose[e]&&userDataMaster.tool[e].num--;AdMaster.closeBannerAd(),egret.Tween.removeAllTweens(),sceneMaster.changeScene(new runningScene(t.level,{},t.choose))},r)},t.prototype.videoFun=function(){var e=this;return this.level<=userDataMaster.level?void e.startFun(!1):void(userDataMaster.todayFreeLife?userDataMaster.dayFreeLife.num<3?(CallbackMaster.openShare(function(){userDataMaster.dayFreeLife.num++,e.startFun(!1)},e.shareCount_2),e.shareCount_2++):AdMaster.useVideo(function(){userDataMaster.dayFreeLife.num++,e.startFun(!1)},function(){platform.showModal({title:"温馨提示",content:"没有可以观看的视频"})}):platform.showModal({title:"温馨提醒",content:"今日免体力次数已用完，请明日再来"}))},t.prototype.closeFun=function(){AdMaster.closeBannerAd(),egret.Tween.removeTweens(this.glassImg),this.bulletImg&&this.bulletImg.parent&&egret.Tween.removeTweens(this.bulletImg),sceneMaster.littleModal?sceneMaster.closeLittleModal():sceneMaster.closeModal()},t}(eui.Component);__reflect(playBefore.prototype,"playBefore",["eui.UIComponent","egret.DisplayObject"]);var rankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){},t.prototype.dataChanged=function(){this.data.rank.length>4&&(this.data.rank=this.data.rank.slice(0,4)+"…"),this.index.text=this.data.rank+"",this.headimg.source=this.data.avatarUrl,this.level.text="关卡"+this.data.level,this.score.text=this.data.score,this.data.nickName.length>5&&(this.data.nickName=this.data.nickName.slice(0,5)+"…"),this.nickName.text=this.data.nickName,this.headimg.mask=this.headimgMask,this.data.rank<4?(this.bestHat.visible=!0,this.bestHat.texture=RES.getRes("icn_medal_0"+this.data.rank+"_png")):this.bestHat.visible=!1;for(var e=1;e<=this.data.star;e++)this["star_"+e].texture=RES.getRes("img_star_b1_png")},t}(eui.ItemRenderer);__reflect(rankItem.prototype,"rankItem",["eui.UIComponent","egret.DisplayObject"]);var rankModal=function(e){function t(){var t=e.call(this)||this;return t.dataGroup=new eui.DataGroup,t.sourceArr=new eui.ArrayCollection([]),t.currentType="friend",t.worldPage=1,t.endPage=1,t.pageSize=6,t}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bgImg?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this,t=this,r=t.stage.stageHeight-1334;t.bgImg.height+=r,t.contentGroup.y+=.5*r,platform.openDataContext.postMessage({type:"rank",width:588,height:740});var o=platform.openDataContext.createDisplayObject();this.friendGroup.addChild(o),this.dataGroup.dataProvider=this.sourceArr,this.dataGroup.itemRenderer=rankItem;var n=new eui.VerticalLayout;n.gap=5,this.dataGroup.layout=n,this.worldGroup.addChild(this.dataGroup),this.getWorld(),this.lastPage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.changePage("-1")},this),this.nextPage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.changePage("+1")},this),this.goHome.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goHomeFun,this),this.friend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.friendFun,this),this.world.addEventListener(egret.TouchEvent.TOUCH_TAP,this.worldFun,this)},t.prototype.changePage=function(e){"friend"==this.currentType?this.getMore(e):("-1"==e?this.worldPage>1?this.worldPage--:1:this.worldPage<this.endPage?this.worldPage++:"",this.getWorld())},t.prototype.getWorld=function(){var e=this,t=this,r={uid:userDataMaster.getMyInfo.uid,page:t.worldPage,size:t.pageSize};ServiceMaster.post(ServiceMaster.rank_world,r,function(r){if(1==r.code&&r.data){var o=r.data.rank_world;t.myRank.text="您当前为：第"+r.data.rank_user.rank+"名",t.endPage=r.data.page_num,t.sourceArr.removeAll(),e.pageText.text=t.worldPage+" / "+t.endPage;for(var n=0;n<o.length;n++)t.sourceArr.addItem(o[n])}})},t.prototype.friendFun=function(){this.pageText.visible=!1,this.myRank.visible=!1,this.friend.texture=RES.getRes("btn_tittle_a1_png"),this.world.texture=RES.getRes("btn_tittle_b2_png"),this.friendGroup.visible=!0,this.worldGroup.visible=!1,this.currentType="friend"},t.prototype.worldFun=function(){this.pageText.visible=!0,this.myRank.visible=!0,this.friend.texture=RES.getRes("btn_tittle_a2_png"),this.world.texture=RES.getRes("btn_tittle_b1_png"),this.friendGroup.visible=!1,this.worldGroup.visible=!0,this.currentType="world"},t.prototype.getMore=function(e){platform.openDataContext.postMessage({type:"rank",page:e,width:588,height:740})},t.prototype.goHomeFun=function(){sceneMaster.closeModal()},t}(eui.Component);__reflect(rankModal.prototype,"rankModal",["eui.UIComponent","egret.DisplayObject"]);var rebornModal=function(e){function t(t,r){var o=e.call(this)||this;return o.level=t,o.myData=r,o}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.ignoreBtn?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this;AdMaster.cacheBannerAd&&AdMaster.openBannerAd({width:700,height:300}),e.ignoreBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ignoreFun,this),setTimeout(function(){e.ignoreBtn.visible=!0},5e3);var t=5,r=setInterval(function(){t>0?(t--,e.num.texture=RES.getRes("img_countdown_0"+t+"_png")):(e.ignoreBtn.visible=!0,clearInterval(r))},1e3)},t.prototype.ignoreFun=function(){AdMaster.closeBannerAd(),sceneMaster.openModal(new gameOver(this.level,this.myData))},t}(eui.Component);__reflect(rebornModal.prototype,"rebornModal",["eui.UIComponent","egret.DisplayObject"]);var shopItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.dataChanged=function(){if(this.img.texture=RES.getRes(this.data.img+"_png"),this.power.texture=RES.getRes("img_power_0"+this.data.powerImg+"_png"),this.txt.text=this.data.txt,0==this.data.id?this.bgImg.texture=RES.getRes("img_bg_bullet_01_png"):this.bgImg.texture=RES.getRes("img_bg_bullet_02_png"),0==userDataMaster.bulletSateArr[this.data.id]&&userDataMaster.gold<this.data.price)this.btn.texture=RES.getRes("btn_insufficient_png");
else{var e=0==userDataMaster.bulletSateArr[this.data.id]?"btn_buy":"btn_use";this.btn.texture=RES.getRes(e+"_png")}this.data.id==userDataMaster.bulletIndex&&(this.btn.texture=RES.getRes("img_using_png")),this.title.text=this.data.title,this.price.text="x"+this.data.price,this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getFun,this)},t.prototype.getFun=function(){if(0==userDataMaster.bulletSateArr[this.data.id])if(userDataMaster.gold>=this.data.price){userDataMaster.bulletSateArr[this.data.id]=1,userDataMaster.myGold=userDataMaster.gold-this.data.price;var e=userDataMaster.bulletArr[this.data.id];sceneMaster.openLittleModal(new getSuccess(e.img+"_png",e.title))}else{var t=new eui.Label("砖石不足");t.size=30,t.textColor=16777215,t.x=(750-t.width)/2,t.y=500,this.parent.addChild(t),egret.Tween.get(t).to({y:100},1e3).to({alpha:0},500).call(function(){t.parent&&t.parent.removeChild(t)})}else 1==userDataMaster.bulletSateArr[this.data.id]&&(userDataMaster.myBulleIndex=this.data.id,console.log("使用这个"))},t}(eui.ItemRenderer);__reflect(shopItem.prototype,"shopItem",["eui.UIComponent","egret.DisplayObject"]);var squareGuide=function(e){function t(t){void 0===t&&(t=1);var r=e.call(this)||this;return r.type=1,r.type=t,r}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){2==this.type&&(this.txt_1.text="难度升级",this.txt_2.text="出现会移动的方块",this.img.texture=RES.getRes("img_diamonds_big_02_png")),egret.Tween.get(this.txtGroup,{loop:!0}).to({y:50},500).to({y:100},500),this.knowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.knowFun,this)},t.prototype.knowFun=function(){egret.Tween.removeTweens(this.txtGroup),sceneMaster.closeModal()},t}(eui.Component);__reflect(squareGuide.prototype,"squareGuide",["eui.UIComponent","egret.DisplayObject"]);var teachModal=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bgImg?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this.stage.stageHeight-1334;this.bgImg.height+=e,this.contentGroup.y+=.5*e,this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeFun,this)},t.prototype.closeFun=function(){sceneMaster.closeModal()},t}(eui.Component);__reflect(teachModal.prototype,"teachModal",["eui.UIComponent","egret.DisplayObject"]);var tipsCom=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){var e=this,t=["当你打不过了，去找新的植物炮弹帮助你吧","你知道吗？包菜君可以说是最厉害的弹药了","某些道具要到特定关卡才会开启哦","开局道具记得选，整局游戏都能用，很强","游戏中不要吝啬使用左下角的道具","偷偷告诉你，旧关卡不消耗体力，还能赚宝石","没有体力，点击“获取体力”，它会帮助你","“免费礼物”有好东西，多去看看"],r=0,o=1;e.tip_1.text=t[r],e.tip_2.text=t[o],e.tip_1.mask=e.reckMask_1,e.tip_2.mask=e.reckMask_2,egret.Tween.get(e.tip_1,{loop:!0}).wait(5e3).to({y:-30},600).to({y:90},0).call(function(){r=o+1<t.length-1?o+1:0,e.tip_1.text=t[r]}).wait(5e3).to({y:30},600),egret.Tween.get(e.tip_2,{loop:!0}).wait(5e3).to({y:30},600).wait(5e3).to({y:-30},600).to({y:90},0).call(function(){o=r+1<t.length-1?r+1:0,e.tip_2.text=t[o]})},t}(eui.Component);__reflect(tipsCom.prototype,"tipsCom",["eui.UIComponent","egret.DisplayObject"]),window.tipsCom=tipsCom;var toolGuide=function(e){function t(t){void 0===t&&(t=0);var r=e.call(this)||this;return r.type=1,r.arr=["可击碎任意方块","可使弹药威力加倍","可控制砖块不下落"],r.type=t,r}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){var e=this;e.txt_2.text=e.arr[e.type]},t}(eui.Component);__reflect(toolGuide.prototype,"toolGuide",["eui.UIComponent","egret.DisplayObject"]);var cloudCom=function(e){function t(t){var r=e.call(this)||this;return r.title=t,r}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.init()},t.prototype.init=function(){this.img_1.texture=RES.getRes(this.title+"_left_png"),this.img_2.texture=RES.getRes(this.title+"_right_png"),egret.Tween.get(this.img_1,{loop:!0}).to({x:-750},1e4).to({x:750},0).to({x:0},1e4),egret.Tween.get(this.img_2,{loop:!0}).to({x:0},1e4).to({x:-750},1e4).to({x:750},0)},t}(eui.Component);__reflect(cloudCom.prototype,"cloudCom",["eui.UIComponent","egret.DisplayObject"]);var gameOver=function(e){function t(t,r){var o=e.call(this)||this;return o.level=t,o.myData=r,o}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.homeBtn?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this;AdMaster.cacheBannerAd&&AdMaster.openBannerAd({width:700,height:300});var t=new eui.DataGroup,r=[];r=userDataMaster.recommand[2]&&userDataMaster.recommand[2].games?userDataMaster.recommand[2].games.slice(0,4):userDataMaster.recommand[1].games.slice(0,4);var o=new eui.ArrayCollection(r);t.dataProvider=o;var n=new eui.HorizontalLayout;n.gap=-5,t.layout=n,t.itemRenderer=moreItem,e.moreGroup.addChild(t);var i={uid:userDataMaster.myInfo.uid,level:this.level,score:e.myData.score,star:e.myData.star};ServiceMaster.post(ServiceMaster.getScore,i,function(e){1===parseInt(e.code)&&e.data}),this.levelText.text="第"+this.level+"关",this.levelProccess.text=this.myData.amount+"/"+userDataMaster.levelArr[this.level-1].amount,this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareFun,this),this.homeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.homeFun,this),this.playBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playFun,this)},t.prototype.shareFun=function(){CallbackMaster.openShare(null,-1)},t.prototype.homeFun=function(){AdMaster.closeBannerAd(),egret.Tween.removeAllTweens(),sceneMaster.changeScene(new startScene)},t.prototype.playFun=function(){AdMaster.closeBannerAd();var e=this.level;sceneMaster.openLittleModal(new playBefore(e))},t}(eui.Component);__reflect(gameOver.prototype,"gameOver",["eui.UIComponent","egret.DisplayObject"]);var levelCom=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.checkSuccess(0)},t.prototype.checkSuccess=function(e){var t=this;userDataMaster.getDataSuccess?t.init():5>e&&(e++,setTimeout(function(){t.checkSuccess(e)},3e3))},t.prototype.init=function(){var e=this,t=userDataMaster.levelArr;e.sourceArr=new eui.ArrayCollection(t.concat([{level:userDataMaster.levelArr.length+1,text:"敬请期待"}])),e.dataGroup=new eui.DataGroup,e.dataGroup.dataProvider=e.sourceArr;var r=new eui.VerticalLayout;r.gap=0,e.dataGroup.layout=r,e.dataGroup.y=554,e.dataGroup.percentWidth=750,e.dataGroup.percentHeight=130,e.content.height=e.dataGroup.y+130*userDataMaster.levelArr.length+130,e.content.addChildAt(e.dataGroup,4),e.dataGroup.itemRenderer=levelItem,e.dataGroup.useVirtualLayout=!0,userDataMaster.levelStar.length>1&&(this.scroller.viewport.scrollV=130*(userDataMaster.levelStar.length-1)),setTimeout(function(){var t=(userDataMaster.level+1+2)%levelItem.point.length+1;e.head.x=levelItem.point[t-1].x,e.head.y=e.dataGroup.y-e.head.height+levelItem.point[t-1].y+130*userDataMaster.level,e.headimg.source=userDataMaster.myInfo.avatarUrl,e.headimg.mask=e.headmask,e.head.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){sceneMaster.openModal(new playBefore(userDataMaster.level+1))},this)},300),userDataMaster.myCollection.addEventListener(eui.CollectionEvent.COLLECTION_CHANGE,this.dataChange,this)},t.prototype.dataChange=function(e){var t=this;if(2==e.location||5==e.location){var r=(userDataMaster.level+1+2)%levelItem.point.length+1;t.head.x=levelItem.point[r-1].x,t.head.y=t.dataGroup.y-t.head.height+levelItem.point[r-1].y+130*userDataMaster.level,t.headimg.source=userDataMaster.myInfo.avatarUrl,t.headimg.mask=t.headmask,t.sourceArr.refresh()}},t}(eui.Component);__reflect(levelCom.prototype,"levelCom",["eui.UIComponent","egret.DisplayObject"]);var runningScene=function(e){function t(t,r,o){void 0===r&&(r={}),void 0===o&&(o={glass:!1,bullet:!1});var n=e.call(this)||this;return n.arcPro=new egret.Shape,n.factor=50,n.currentTimer=egret.getTimer(),n.ceilArr=[],n.adaptParams={gridAreaTop:204,gridAreaLeft:39,itemWidth:96},n.worldSpeed=1e3,n.ballSpeed=800,n.gridArr=[],n.beeArr=[],n.shooting=!1,n.myData={beeNum:5,amount:0,existAmount:0,score:0,reborn:0,gold:0,star:0,line:0,danger:0,reborning:0},n.tooling=null,n.hatPower=!1,n.chooseTool={glass:!1,bullet:!1},n.shootPoint={bx:375,by:1054,ex:0,ey:0,floor:!1,beeNum:0,speedy:3,shootAll:!1},n.conTimes={num:0,score:0},n.prepare=!1,n.shareCount={count_1:0,count_2:0,count_3:3},n.levelInfo=userDataMaster.levelArr[t-1],r&&r.beeNum&&(n.myData=r),n.chooseTool=o,n}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bgImg?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this;platform.triggerGC(),userDataMaster.myInfo.gender&&(e.heroImg.texture=RES.getRes("img_role_"+userDataMaster.myInfo.gender+"_png")),e.myData.beeNum=e.levelInfo.bullet,e.levelText.text=e.levelInfo.level+"",e.bulletImg.texture=RES.getRes(userDataMaster.bulletArr[userDataMaster.bulletIndex].img+"_png"),e.bulletNum.text="X"+e.myData.beeNum,e.amountText.text=e.myData.amount+"/"+e.levelInfo.amount,e.myData.gold=e.levelInfo.gold,e.bgImg.height=e.stage.stageHeight,e.world=new p2.World,e.world.sleepMode=p2.World.BODY_SLEEPING,e.world.gravity=[0,-10],e.world.defaultContactMaterial.restitution=1,e.createCeil();for(var t=3;t>0;t--)e.createGrids(t,!0);for(var t=1;t<=e.myData.star;t++)e["star_"+t].texture=RES.getRes("img_star_b1_png");e.scoreProccess.addChildAt(e.arcPro,2),e.scoreText.text=e.myData.score+"",e.changeGraphics(),e.initBee(),e.world.on("beginContact",e.onBeginContact,this),e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,this);var r=100;e.chooseTool.bullet&&(setTimeout(function(){var t=movieMaster.getGif("cartridge");t.anchorOffsetX=205,t.anchorOffsetY=185,t.x=375,t.y=600,e.addChild(t),t.gotoAndPlay(1,1),t.addEventListener(egret.Event.COMPLETE,function(r){for(var o=function(r,o){setTimeout(function(){var n=new beeCom;n.createBody(e,7.5,e.getPosition(600)),n.boxBody.velocity[1]=-20,e.beeArr.push(n),e.shootPoint.beeNum++,e.myData.beeNum++,e.bulletNum.text="X"+e.myData.beeNum,r==o-1&&egret.Tween.get(t).to({scaleX:0,scaleY:0},1e3).call(function(){t.parent&&t.parent.removeChild(t)})},100*r)},n=0,i=5;i>n;n++)o(n,i)},this)},r),r+=3e3),e.chooseTool.glass&&(setTimeout(function(){var t=movieMaster.getGif("glass");t.x=225,t.y=600,e.addChild(t),e.swapChildren(t,e.hero),t.gotoAndPlay(1,1),t.addEventListener(egret.Event.COMPLETE,function(r){egret.Tween.get(t).to({y:900},1e3).to({alpha:0},500).call(function(){e.swapChildren(t,e.hero),t.parent&&t.parent.removeChild(t),e.hero.rotation=-30;var r=e.createBitmapByName("img_glass");r.x=27,r.y=68,e.hero.addChild(r),setTimeout(function(){e.hero.rotation=0},500)})},this)},r),r+=4e3),setTimeout(function(){e.prepare=!0,e.updateBee(),0==userDataMaster.levelStar.length&&1==e.levelInfo.level&&(e.userTip=e.createBitmapByName("new_user_text"),e.userTip.x=(e.stage.stageWidth-e.userTip.width)/2,e.userTip.y=800,e.addChild(e.userTip),egret.Tween.get(e.userTip,{loop:!0}).to({alpha:0},1e3).to({alpha:1},1e3)),2==userDataMaster.levelStar.length&&3==e.levelInfo.level&&sceneMaster.openModal(new squareGuide),5==userDataMaster.levelStar.length&&6==e.levelInfo.level&&sceneMaster.openModal(new squareGuide(2)),e.rayGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginFun,e),e.rayGroup.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.touchMoveFun,e),e.rayGroup.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEndFun,e)},r),e.toolState(r),e.homeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.homeFun,this),platform.onShow(function(){console.log("onshow"),e.currentTimer=egret.getTimer()})},t.prototype.homeFun=function(){var e=this;platform.showModal({title:"温馨提示",content:"返回首页将会损失一点体力，是否继续？",success:function(t){t.confirm&&(e.removeEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),egret.Tween.removeAllTweens(),e.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginFun,e),e.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_MOVE,e.touchMoveFun,e),e.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_END,e.touchEndFun,e),sceneMaster.changeScene(new startScene))}})},t.prototype.initBee=function(){for(var e=this,t=0,r=e.myData.beeNum;r>t;t++){var o=new beeCom;o.createBody(e),e.beeArr.push(o),e.shootPoint.beeNum++}e.updateBee()},t.prototype.toolState=function(e){for(var t=this,r=["hammer","hat","lamp"],o=function(o){var i=userDataMaster.tool[r[o]];if(userDataMaster.level+1>=i.level){t[r[o]+"_lock"].parent&&t[r[o]+"_lock"].parent.removeChild(t[r[o]+"_lock"]);t[r[o]+"_img"].y;setTimeout(function(){egret.Tween.get(t[r[o]+"_img"],{loop:!0}).wait(5e3).to({scaleX:1,scaleY:1},500).to({scaleX:.8,scaleY:.8},500)},1500*o),i.unlock||(userDataMaster.tool[r[o]].unlock=!0,setTimeout(function(){t.addChild(sceneMaster.modalBg),t.tg=new toolGuide(o),t.addChild(t.tg),t.tg.addChild(t[r[o]]),t.tg.x=121*o+30,t.tg.y=990,t[r[o]].x=0,t[r[o]].y=200,t.once(egret.TouchEvent.TOUCH_TAP,function(){t.tg.txt_1.visible=!1,t.tg.txt_2.visible=!1,t.tg.txt_3.visible=!0},this)},e)),t[r[o]].addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.judgeTool(r[o],o)},n)}else t[r[o]+"_img"].parent&&t[r[o]].removeChild(t[r[o]+"_img"]),t[r[o]+"_lock"].visible=!0,t[r[o]+"_text"].visible=!0},n=this,i=0;i<r.length;i++)o(i)},t.prototype.judgeTool=function(e,t){function r(){userDataMaster.tool[e].num++,o.judgeTool(e,t)}var o=this;if(!(o.tg&&o.tg.txt_1.visible||o.shooting))if(sceneMaster.modalBg.parent&&sceneMaster.scene.removeChild(sceneMaster.modalBg),o.tg&&o.removeChild(o.tg),o[e].x=121*t,o[e].y=0,o.toolBottom.addChild(o[e]),o.conTimes={num:0,score:0},userDataMaster.tool[e].num>0){if(o.tooling=e,userDataMaster.tool[e].num--,"hammer"==e){var n=new eui.Group;o.addChildAt(n,9);var i=new eui.Rect(o.stage.stageWidth,o.stage.stageHeight,787200);i.alpha=.85,n.addChild(i);var a=o.createBitmapByName("img_text_05");a.x=375-a.width/2,a.y=1190,n.addChild(a);var s=o.createBitmapByName("img_prop_game_01");s.anchorOffsetX=s.width,s.anchorOffsetY=s.height,s.x=375-s.width/4,s.y=1320,n.addChild(s),egret.Tween.get(s,{loop:!0}).to({rotation:30},200).to({rotation:0},200),o.hammerShow=n}else if("hat"==e){o.hatPower=!0;var l=o.createBitmapByName("img_helmet");l.anchorOffsetX=l.width/2,l.anchorOffsetX=l.y/2,l.x=375,l.y=600,o.addChild(l),egret.Tween.get(l).to({y:1100,scaleX:.6,scaleY:.6},1e3).call(function(){l.parent&&l.parent.removeChild(l),o.hero.rotation=-30;var e=o.createBitmapByName("img_helmet");e.x=77,e.y=43,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.scaleX=.6,e.scaleY=.6,o.hero.addChild(e),setTimeout(function(){o.hero.rotation=0;var e=o.createBitmapByName("img_text_06");e.x=(750-e.width)/2,e.y=900,o.addChild(e),egret.Tween.get(e).to({y:600},3e3).wait(1e3).call(function(){e.parent&&e.parent.removeChild(e)})},500)})}else if("lamp"==e){o.lampShow&&o.lampShow.parent&&o.lampShow.parent.removeChild(o.lampShow);var n=new eui.Group;o.addChild(n),o.swapChildren(n,o.rayGroup);var d=o.createBitmapByName("img_traffic_light_02");d.x=(o.stage.stageWidth-d.width)/2,d.y=195,n.addChild(d);var u=o.createBitmapByName("img_traffic_02");u.x=40,u.y=1e3,n.addChild(u);var c=o.createBitmapByName("img_traffic_01");c.x=710-c.width,c.y=1e3,n.addChild(c),o.lampShow=n}}else CallbackMaster.openShare(function(){r()},o.shareCount.count_1),o.shareCount.count_1++},t.prototype.createCeil=function(){for(var e=[{x:697,y:480,width:1,height:25},{x:-25,y:480,width:1,height:25},{x:336,y:-25,width:15,height:1},{x:336,y:940,width:15,height:1}],t=0,r=e.length;r>t;t++){var o=e[t],n=new p2.Body({mass:1,position:[this.getPosition(o.x,2),this.getPosition(o.y)],type:p2.Body.KINEMATIC}),i=new p2.Box({width:o.width,height:o.height});i.collisionGroup=6,i.collisionMask=5,n.addShape(i),n.displays=[],this.world.addBody(n),this.ceilArr.push(n)}},t.prototype.getPosition=function(e,t){void 0===t&&(t=1);var r=this.adaptParams,o=0;return o=1==t?(this.stage.stageHeight-(r.gridAreaTop+e))/this.factor:(r.gridAreaLeft+e)/this.factor},t.prototype.hitDown=function(e){void 0===e&&(e=!1);var t=this;t.myData.amount++,t.amountText.text=t.myData.amount+"/"+t.levelInfo.amount,t.amountPro.width=t.myData.amount/t.levelInfo.amount*100,t.myData.amount>=t.levelInfo.amount&&e&&setTimeout(function(){t.removeEventListener(egret.Event.ENTER_FRAME,t.onEnterFrame,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginFun,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMoveFun,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_END,t.touchEndFun,t),sceneMaster.modal||(t.world=null,sceneMaster.openModal(new levelUpModal(t.levelInfo.level,t.myData)))},500)},t.prototype.updateProccess=function(e){var t=this;if(t.myData.score+=e.score,e.num>2){var r=250*e.num,o="img_text_a1";o=e.num<5?"img_text_a1":e.num<7?"img_text_a2":"img_text_a3",t.myData.score+=r,t.createGif(o,2,1e3);var n=new egret.BitmapText;n.font=RES.getRes("stripe_text_big_fnt"),n.text="+"+r,n.x=375,n.y=500,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.scaleX=0,n.scaleY=0,t.addChild(n),egret.Tween.get(n).to({scaleX:1,scaleY:1},500).wait(1e3).to({alpha:0},1e3).call(function(){n.parent&&n.parent.removeChild(n)})}t.myData.star<1&&t.myData.score>=t.levelInfo.score&&(t.star_1.texture=RES.getRes("img_star_b1_png"),t.myData.star=1),t.myData.star<2&&t.myData.score>=3*t.levelInfo.score&&(t.star_2.texture=RES.getRes("img_star_b1_png"),t.myData.star=2),t.myData.star<3&&t.myData.score>=6*t.levelInfo.score&&(t.star_3.texture=RES.getRes("img_star_b1_png"),t.myData.star=3),t.scoreText.text=t.myData.score+"",t.changeGraphics()},t.prototype.createGif=function(e,t,r){var o=this,n=new eui.Group;n.width=600,n.height=450,n.anchorOffsetX=300,n.anchorOffsetY=225,n.x=375,n.y=600;var i=movieMaster.getGif("gif_streamer");n.addChild(i);var a=o.createBitmapByName(e);a.x=(n.width-a.width)/2,a.y=260,n.addChild(a),o.addChild(n),i.gotoAndPlay(1,t),egret.Tween.get(n).to({scaleX:1,scaleY:1},500).wait(r).to({scaleX:0,scaleY:0},1e3).call(function(){n.parent&&n.parent.removeChild(n)})},t.prototype.createGrids=function(e,t){void 0===e&&(e=1),void 0===t&&(t=!1);var r=this;if(r.myData.amount>=r.levelInfo.amount&&(r.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,r.touchBeginFun,r),r.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_MOVE,r.touchMoveFun,r),r.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_END,r.touchEndFun,r),r.createGif("img_text_a4",5,2e3),setTimeout(function(){r.removeEventListener(egret.Event.ENTER_FRAME,r.onEnterFrame,r),sceneMaster.modal||(r.world=null,sceneMaster.openModal(new levelUpModal(r.levelInfo.level,r.myData)))},2e3)),!(r.myData.existAmount>=r.levelInfo.amount)){for(var o=0;7>o&&!(r.myData.existAmount>=r.levelInfo.amount);o++){var n=void 0,i=Math.random()<.7?1:2,a=Math.random();if(r.levelInfo.level>=3&&r.levelInfo.level<6){var s=Math.random();i=.15>s?5:.7>s?1:2}if(r.levelInfo.level>=6){var s=Math.random();i=.1>s?5:.3>s?6:.8>s?1:2}if(2==userDataMaster.levelStar.length&&3==r.levelInfo.level&&3==e&&t&&4==o&&(a=.2,i=5),5==userDataMaster.levelStar.length&&6==r.levelInfo.level&&3==e&&t&&3==o&&(a=.2,i=6),.45>a&&r.myData.existAmount<r.levelInfo.amount){var l=Math.floor(r.levelInfo.small+r.myData.line);n=new gridCom(l,i),r.myData.existAmount++}else if(.52>a)n=new ballCom;else{if(!(.62>a))continue;n=new starCom}var d=o*r.adaptParams.itemWidth+r.adaptParams.itemWidth/2,u=e*r.adaptParams.itemWidth+r.adaptParams.itemWidth/2;r.world.addBody(n.createBody(r.getPosition(d,2),r.getPosition(u),r)),r.gridArr.push(n)}r.myData.line++}},t.prototype.touchBeginFun=function(e){function t(){r.rayGroup.addEventListener(egret.TouchEvent.TOUCH_MOVE,r.touchMoveFun,r),r.rayGroup.addEventListener(egret.TouchEvent.TOUCH_END,r.touchEndFun,r),r.tooling=null,setTimeout(function(){r.hammerShow.parent&&r.hammerShow.parent.removeChild(r.hammerShow)},500)}if(!this.shooting){var r=this;if(r.hammerShow&&"hammer"==r.tooling)for(var o=function(o,n){var i=r.gridArr[o].img.hitTestPoint(e.stageX,e.stageY);if(i){if(3==r.gridArr[o].type||4==r.gridArr[o]);else{var a=r.createBitmapByName("img_prop_game_01");a.anchorOffsetX=a.width,a.anchorOffsetY=a.height,a.x=r.gridArr[o].img.x+a.width/2,a.y=r.gridArr[o].img.y+a.height/2,r.addChild(a),egret.Tween.get(a).to({rotation:20},200).to({rotation:0},200).to({rotation:30},200).to({rotation:0},200).call(function(){a.parent&&a.parent.removeChild(a),r.conTimes.score+=r.gridArr[o].initNum,r.gridArr[o].updateText(r,r.gridArr[o].initNum,function(){r.hitDown(!0),r.updateProccess(r.conTimes),t()})})}return"break"}},n=0,i=this.gridArr.length;i>n;n++){var a=o(n,i);if("break"===a)break}else r.userTip&&r.userTip.parent&&(egret.Tween.removeTweens(r.userTip),r.userTip.parent.removeChild(r.userTip)),this.touchMoveFun(e)}},t.prototype.useTool=function(e){},t.prototype.touchMoveFun=function(e){var t=this;t.shooting||t.hammerShow&&t.hammerShow.parent||(t.shootPoint.ex=e.stageX,t.shootPoint.ey=e.stageY,t.shootPoint.speedy=1,t.rayGroup.removeChildren(),e.stageY>t.shootPoint.by||t.testRay())},t.prototype.touchEndFun=function(e){var t=this;if(!(t.shooting||t.hammerShow&&t.hammerShow.parent||e.stageY>t.shootPoint.by)){!t.lampShow||!t.lampShow.parent||t.tooling&&"lamp"==t.tooling||(t.lampShow.parent&&t.lampShow.parent.removeChild(t.lampShow),t.lampShow=null),t.shootPoint.speedy=3,t.shootPoint.ex=e.stageX,t.shootPoint.ey=e.stageY;var r=t.shootPoint.ex-t.shootPoint.bx,o=t.shootPoint.ey-t.shootPoint.by,n=t.shootPoint.bx/t.factor,i=(t.stage.stageHeight-t.shootPoint.by)/t.factor;t.rayGroup.removeChildren(),t.hero.rotation=0,t.conTimes={num:0,score:0},setTimeout(function(){t.shooting=!0},100);for(var a=function(e){var a=t.beeArr[e].boxBody;setTimeout(function(){egret.Tween.removeTweens(a.displays[0]),a.position[0]=n,a.position[1]=i,a.velocity=[r/t.factor,-o/t.factor],a.gravityScale=0,t.updateSpeed(a),e==t.beeArr.length-1&&(t.shootPoint.shootAll=!0)},100*e)},s=0;s<t.beeArr.length;s++)a(s)}},t.prototype.testRay=function(){var e=this,t=e.shootPoint.bx/e.factor,r=(e.stage.stageHeight-e.shootPoint.by)/e.factor,o=e.shootPoint.ex/e.factor,n=(e.stage.stageHeight-e.shootPoint.ey)/e.factor;if(r>=n)return void console.log("小于发射水平线");var i=o-t,a=n-r,s=new p2.Ray({from:[t,r],to:[o+25/a*i,n+25],mode:p2.Ray.CLOSEST,checkCollisionResponse:!0,skipBackfaces:!1,collisionGroup:1,collisionMask:4});e.hero.rotation=350;var l=new p2.RaycastResult;e.world.raycast(l,s),l&&l.body&&(e.createLine(l,s),e.chooseTool.glass&&e.testRay2(l,s))},t.prototype.testRay2=function(e,t,r){void 0===r&&(r=!1);var o=this,n=[0,0];e.getHitPoint(n,t);var i=n[0],a=n[1],s=0,l=0;if(Math.abs(e.normal[0])<1e-15)s=2*i-t.from[0],l=t.from[1];else if(Math.abs(e.normal[1])<1e-15)s=t.from[0],l=2*a-t.from[1];else{var d=e.normal[1]/e.normal[0],u=(t.from[0]-n[0]-d*d*t.from[0]+d*d*n[0]+2*d*t.from[1]-2*d*n[1])/(d*d+1),c=d*t.from[0]-d*t.from[1]+u*d-n[0]+n[1];u+=n[0],c+=n[1],s=u,l=c}var h=s-i,p=l-a;s>i&&h*p>=0||i>s&&0>=h*p?(i+=.1/p*h,a+=.1,s+=25/p*h,l+=25):(i-=.1/p*h,a-=.1,s-=25/p*h,l-=25);var g=new p2.Ray({from:[i,a],to:[s,l],mode:p2.Ray.CLOSEST,checkCollisionResponse:!0,skipBackfaces:!1,collisionGroup:1,collisionMask:4});o.hero.rotation=350;var m=new p2.RaycastResult;o.world.raycast(m,g),m&&m.body&&(!r&&g.to[1]>7&&o.testRay2(m,g,!0),o.createLine(m,g))},t.prototype.createLine=function(e,t){for(var r=this,o=(r.shootPoint.bx/r.factor,(r.stage.stageHeight-r.shootPoint.by)/r.factor,e.getHitDistance(t)),n=t.to[0]-t.from[0],i=t.to[1]-t.from[1],a=r.chooseTool.glass?2:1,s=0;o-1>s;s++){var l=r.createBitmapByName("img_aim_0"+a);l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2,l.x=(t.from[0]+n/t.length*s)*r.factor-r.rayGroup.x,l.y=r.stage.stageHeight-(t.from[1]+i/t.length*s)*r.factor-r.rayGroup.y,this.rayGroup.addChild(l)}var d=r.createBitmapByName("img_aim_0"+a);d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,d.x=(t.from[0]+n/t.length*(o-.5))*r.factor-r.rayGroup.x,d.y=r.stage.stageHeight-(t.from[1]+i/t.length*(o-.5))*r.factor-r.rayGroup.y,this.rayGroup.addChild(d)},t.prototype.onBeginContact=function(e){var t=this,r=e.bodyA,o=e.bodyB,n=7==r.shapes[0].collisionMask&&o.type==p2.Body.KINEMATIC,i=7==o.shapes[0].collisionMask&&r.type==p2.Body.KINEMATIC,a=7==r.shapes[0].collisionMask&&7==o.shapes[0].collisionMask;if(n||i||a)return r.velocity[0]&&(r.velocity[0]=-r.velocity[0]),void(o.velocity[0]&&(o.velocity[0]=-o.velocity[0]));for(var s=0;s<t.beeArr.length;s++){var l=t.beeArr[s].boxBody;if(r.id==l.id||o.id==l.id){var d;if(r.id==l.id?d=o:o.id==l.id&&(d=r),d.id==t.ceilArr[0].id||d.id==t.ceilArr[1].id||d.id==t.ceilArr[2].id)return void(l.angle=0);if(d.id==t.ceilArr[3].id)return l.angle=0,l.fixedRotation=!0,l.gravityScale=1,void(l.velocity=[0,-t.shootPoint.speedy]);for(var u=function(e){if(t.gridArr[e].boxBody.id==d.id&&t.shooting){if(3==t.gridArr[e].type){if(!t.gridArr[e].isRemoved){t.shootPoint.beeNum++;var r=t.gridArr[e].boxBody.position[0];t.gridArr[e].updateText(t,function(){var e=new beeCom;e.createBody(t,r),t.beeArr.push(e),t.myData.beeNum++,t.bulletNum.text="X"+t.myData.beeNum})}}else if(4==t.gridArr[e].type)t.beeArr[s].powerUp(2),t.gridArr[e].updateText(t);else if(!t.gridArr[e].isRemoved){var o=t.beeArr[s].power;t.hatPower&&(o*=2),t.beeArr[s].against&&t.beeArr[s].against["type_"+t.gridArr[e].type]&&(o+=t.beeArr[s].against["type_"+t.gridArr[e].type]);var n=o>t.gridArr[e].num?t.gridArr[e].num:o;t.conTimes.score+=n,soundMaster.playSingleMusic("hit_sound"),platform.vibrateShort({}),t.gridArr[e].updateText(t,o,function(e){t.hitDown()})}return"break"}},c=0;c<t.gridArr.length;c++){var h=u(c);if("break"===h)break}break}}},t.prototype.onEnterFrame=function(){var e=this,t=egret.getTimer()-this.currentTimer;if(!(10>t)){if(t>300)return void(this.currentTimer=egret.getTimer());this.world.step(t/this.worldSpeed),this.currentTimer=egret.getTimer();for(var r=egret.MainContext.instance.stage.stageHeight,o=this.world.bodies.length,n=0;o>n;n++)for(var i=this.world.bodies[n],a=i.displays.length,s=0;a>s;s++){var l=i.displays[s];l&&(0==s&&(l.anchorOffsetX=i.displays[0].width/2),l.x=i.position[0]*this.factor,l.y=r-i.position[1]*this.factor,l.rotation=180*i.angle/Math.PI)}for(var d=0,u=function(t,r){var o=c.beeArr[t].boxBody;if(o.position[1]<e.getPosition(935)&&(o.position[1]=e.getPosition(900)),o.position[1]<=e.getPosition(880)){if(d++,0==o.gravityScale&&(o.velocity[0]=0,o.angle=0,o.displays[0].rotation=0,o.gravityScale=1,c.beeArr[t].powerUp(1),!e.shootPoint.floor)){e.shootPoint.floor=!0,e.shootPoint.bx=o.position[0]*e.factor;var n=e.shootPoint.bx+e.hero.anchorOffsetX-e.hero.width/2,i=Math.abs(e.hero.x-n);egret.Tween.get(e.hero).to({x:n},i)}if(t==r-1&&d==r&&e.shooting&&e.shootPoint.shootAll&&e.shootPoint.beeNum==r){if(1!=e.myData.danger&&1!=e.myData.reborning){var a=e.conTimes;setTimeout(function(){e.updateProccess(a)},300)}if(e.conTimes={num:0,score:0},e.shooting=!1,e.shootPoint.shootAll=!1,e.shootPoint.floor=!1,"lamp"!=e.tooling&&(e.tooling=null,e.hatPower)){var s=e.hero.numChildren;e.hero.removeChildAt(s-1),e.hatPower=!1}setTimeout(function(){1==e.myData.danger||1==e.myData.reborning?(1==e.myData.danger?e.myData.danger=2:e.myData.reborning=2,e.myData.amount>=e.levelInfo.amount&&(e.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginFun,e),e.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_MOVE,e.touchMoveFun,e),e.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_END,e.touchEndFun,e),e.createGif("img_text_a4",5,2e3),setTimeout(function(){e.removeEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),sceneMaster.modal||(e.world=null,sceneMaster.openModal(new levelUpModal(e.levelInfo.level,e.myData)))},2e3))):e.updateGrids(),e.updateBee()},100)}}else 0==o.gravityScale?c.updateSpeed(o):e.prepare&&(o.velocity[1]=-e.shootPoint.speedy,c.beeArr[t].powerUp(1))},c=this,h=0,p=this.beeArr.length;p>h;h++)u(h,p);for(var g=e.gridArr.length,m=g-1;m>=0;m--)if(6==e.gridArr[m].type&&Math.abs(e.gridArr[m].boxBody.velocity[0])>0){var f=e.gridArr[m].boxBody.velocity[0]>0?.8:-.8;e.gridArr[m].boxBody.velocity[0]=f}}},t.prototype.updateBee=function(){var e=this,t=e.shootPoint.bx/e.factor,r=.8,o=e.hero.width/2/e.factor;t>7.5&&(r=-r,o=-o);for(var n=0,i=0,a=e.beeArr.length;a>i;i++)e.beeArr[i].boxBody.position[0]=i*r+t+o,e.beeArr[i].boxBody.position[0]>13.5||e.beeArr[i].boxBody.position[0]<1.5?e.beeArr[i].boxBody.position[0]=i%n*r+t+o/2:n=i},t.prototype.updateGrids=function(){var e=this,t=this;if("lamp"==t.tooling&&t.lampShow){t.tooling=null,t.lampShow.getChildAt(0).texture=RES.getRes("img_traffic_light_01_png");var r=t.createBitmapByName("img_text_07");return r.x=375-r.width/2,r.y=600,t.addChild(r),void egret.Tween.get(r).to({alpha:0},3e3).call(function(){r.parent&&r.parent.removeChild(r)})}for(var o=!1,n=!1,i=t.gridArr.length,a=i-1;a>=0;a--){var s=1==t.gridArr[a].squareType;if(t.gridArr[a].isRemoved||!s&&t.gridArr[a].boxBody.position[1]<=t.getPosition(8*t.adaptParams.itemWidth))t.gridArr[a].img.parent&&4==t.gridArr[a].type&&(t.world.removeBody(t.gridArr[a].boxBody),t.gridArr[a].img.parent.removeChild(t.gridArr[a].img)),t.gridArr.splice(a,1);else{t.gridArr[a].boxBody.position[1]-=t.adaptParams.itemWidth/t.factor;var l=t.gridArr[a].boxBody.position[1];l<=t.getPosition(8*t.adaptParams.itemWidth)&&s?o=!0:l<=t.getPosition(7*t.adaptParams.itemWidth)&&!sceneMaster.modal&&s&&(n=!0,0==t.myData.danger&&(t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginFun,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMoveFun,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_END,t.touchEndFun,t)))}}if(o)t.removeEventListener(egret.Event.ENTER_FRAME,t.onEnterFrame,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginFun,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMoveFun,t),t.rayGroup.removeEventListener(egret.TouchEvent.TOUCH_END,t.touchEndFun,t),setTimeout(function(){if(t.myData.reborn>=1)sceneMaster.openModal(new gameOver(t.levelInfo.level,t.myData));else{var e=new rebornModal(t.levelInfo.level,t.myData);sceneMaster.openModal(e),t.shooting=!1,e.rebornBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,t.rebornFun,t)}},200);else if(n){var d=t.createBitmapByName("img_line_danger");d.x=(750-d.width)/2,d.y=t.adaptParams.gridAreaTop+8*t.adaptParams.itemWidth-10,t.addChild(d),egret.Tween.get(d).to({alpha:0},300).to({alpha:1},300).to({alpha:0},300).to({alpha:1},300).call(function(){if(d.parent&&d.parent.removeChild(d),0==t.myData.danger){var r=new dangerModal;sceneMaster.openModal(r),r.useBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){CallbackMaster.openShare(function(){AdMaster.closeBannerAd(),sceneMaster.closeModal(),t.shooting=!1,t.clearRows(2)},t.shareCount.count_2),t.shareCount.count_2++},e),r.ignoreBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.rayGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginFun,t),t.rayGroup.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMoveFun,t),t.rayGroup.addEventListener(egret.TouchEvent.TOUCH_END,t.touchEndFun,t)},e)}})}if(0==t.gridArr.length)for(var a=3;a>0;a--)t.createGrids(a);
else t.createGrids()},t.prototype.clearRows=function(e){var t=this;2==e?t.myData.danger=1:t.myData.reborning=1;var r=t.gridArr.length,o=t.adaptParams.itemWidth/t.factor,n=0;r>0&&(n=t.gridArr[0].boxBody.position[1]+o*e),setTimeout(function(){for(var e=function(e){if(!(t.gridArr[e].boxBody.position[1]<=n))return"break";if(4==t.gridArr[e].type)t.gridArr[e].updateText(t,function(){t.gridArr[e].img.parent&&t.gridArr[e].img.parent.removeChild(t.gridArr[e].img)});else if(3==t.gridArr[e].type){var r=t.gridArr[e].boxBody.position[0];t.gridArr[e].updateText(t,function(){var e=new beeCom;e.createBody(t,r),t.beeArr.push(e),t.myData.beeNum++,t.bulletNum.text="X"+t.myData.beeNum})}else t.gridArr[e].updateText(t,t.gridArr[e].initNum,function(){soundMaster.playSingleMusic("boom_sound"),t.hitDown()})},o=0;r>o;o++){var i=e(o);if("break"===i)break}t.shooting=!0,t.shootPoint.shootAll=!0,t.rayGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.touchBeginFun,t),t.rayGroup.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.touchMoveFun,t),t.rayGroup.addEventListener(egret.TouchEvent.TOUCH_END,t.touchEndFun,t)},500)},t.prototype.rebornFun=function(){function e(){t.myData.reborn++,AdMaster.closeBannerAd(),sceneMaster.closeModal(),t.currentTimer=egret.getTimer(),t.addEventListener(egret.Event.ENTER_FRAME,t.onEnterFrame,t),t.clearRows(3)}var t=this;AdMaster.useVideo(function(){e()},function(){CallbackMaster.openShare(function(){e()},t.shareCount.count_3),t.shareCount.count_3++})},t.prototype.updateSpeed=function(e){e.position[0]<this.getPosition(-20,2)&&(e.velocity[0]=-e.velocity[0],e.position[0]=this.getPosition(20,2)),e.position[0]>this.getPosition(692,2)&&(e.velocity[0]=-e.velocity[0],e.position[0]=this.getPosition(652,2)),e.position[1]>this.getPosition(-10)&&(e.velocity[1]=-e.velocity[1],e.position[1]=this.getPosition(20)),e.position[1]<this.getPosition(945)&&(e.position[1]=this.getPosition(910));var t=e.velocity;Math.abs(t[1])<.5&&(t[1]=t[1]>0?.5:-.5);var r=Math.sqrt(this.ballSpeed/(t[0]*t[0]+t[1]*t[1]));e.velocity=[r*t[0],r*t[1]];var o=Math.atan(t[1]/t[0]);0>o&&(o=2*Math.PI+o),o=-(o-Math.PI/2),t[0]<0&&(o-=Math.PI),e.angle=o},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e+"_png");return t.texture=r,t},t.prototype.changeGraphics=function(){var e=this.myData.score/(6*this.levelInfo.score);e=e>1?1:e;var t=2*e*Math.PI*3/4+.55*Math.PI;this.arcPro.graphics.clear(),this.arcPro.graphics.lineStyle(14,16768862,1),this.arcPro.graphics.drawArc(60,60,50,.55*Math.PI,t,!1),this.arcPro.graphics.endFill()},t}(eui.Component);__reflect(runningScene.prototype,"runningScene",["eui.UIComponent","egret.DisplayObject"]);var startScene=function(e){function t(){var t=e.call(this)||this;return t.targetArr=["lifeGroup","goldGroup","openLife","openShare","openBullet","openShop","openRank","openGift"],t.shareCount=0,t}return __extends(t,e),t.prototype.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.bgImg?this.init():this.addEventListener(egret.Event.COMPLETE,this.init,this)},t.prototype.init=function(){var e=this;e.bgImg.height=e.stage.stageHeight,e.navGroup.y+=e.stage.stageHeight-1334,e.liftText.text=userDataMaster.life+"/5",e.goldText.text=userDataMaster.gold+"",e.createRecommand();var t=levelCom.getInstance();e.addChildAt(t,1),egret.Tween.removeTweens(t.light),egret.Tween.get(t.light,{loop:!0}).to({rotation:360},3e3),t.scroller.height=e.stage.stageHeight;var r=new cloudCom("cloud_top");e.addChildAt(r,2);var o=new cloudCom("cloud_bottom");e.addChildAt(o,3),o.y=e.stage.stageHeight-o.height,egret.Tween.get(e.bullet_new_icon,{loop:!0}).to({y:-20},1e3).to({y:-8},1e3),setTimeout(function(){e.chooseSex(0)},1e3),e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.judgeFun,e),userDataMaster.myCollection.addEventListener(eui.CollectionEvent.COLLECTION_CHANGE,this.dataChange,this)},t.prototype.chooseSex=function(e){var t=this;userDataMaster.myInfo.uid?userDataMaster.myInfo.gender&&userDataMaster.myInfo.gender>0||sceneMaster.openModal(new chooseSex):e++<5&&setTimeout(function(){t.chooseSex(e)},1e3)},t.prototype.createRecommand=function(e){void 0===e&&(e=0);var t=this;if(userDataMaster.recommand&&userDataMaster.recommand[1]&&userDataMaster.recommand[1].games){for(var r=new eui.DataGroup,o=userDataMaster.recommand[1].games.slice(0,3),n=0;n<o.length;n++)o[n].color_1=1461811;var i=new eui.ArrayCollection(o);r.dataProvider=i;var a=new eui.VerticalLayout;a.gap=20,r.layout=a,r.itemRenderer=moreItem,t.moreGroup.addChild(r),t.moreComponent=moreComponent.getInstance(),t.moreComponent.y=350,t.addChild(t.moreComponent),t.moreComponent.changeArea.texture=RES.getRes("btn_more_game_png")}else e++,setTimeout(function(){t.createRecommand(e)},300)},t.prototype.dataChange=function(e){this.liftText.text=userDataMaster.life+"/5",this.goldText.text=userDataMaster.gold+""},t.prototype.judgeFun=function(e){var t=this;if(!sceneMaster.modal)for(var r=0,o=t.targetArr;r<o.length;r++){var n=o[r],i=t[n],a=e.stageX-(i.x-i.anchorOffsetX+i.parent.x),s=e.stageY-(i.y-i.anchorOffsetY+i.parent.y);if(a>0&&a<i.width&&s>0&&s<i.height)return void(t[n+"Fun"]&&t[n+"Fun"]())}},t.prototype.lifeGroupFun=function(){var e=this;e.openLifeFun()},t.prototype.goldGroupFun=function(){function e(){userDataMaster.dayShareGold.num++,userDataMaster.myGold=userDataMaster.gold+20,sceneMaster.openModal(new getSuccess("img_diamond_big_png","X20"))}var t=this;return userDataMaster.todayShareGold?(CallbackMaster.openShare(function(){e()},t.shareCount),void t.shareCount++):void platform.showModal({title:"温馨提示",content:"今日获取次数已达上限，请明日再来"})},t.prototype.openLifeFun=function(){var e=this;e.life_dot.visible=!1,sceneMaster.openModal(new getLifeModal)},t.prototype.openShareFun=function(){CallbackMaster.openShare(null,-1)},t.prototype.openBulletFun=function(){var e=this;egret.Tween.removeTweens(e.bullet_new_icon),e.bullet_new_icon.parent&&e.bullet_new_icon.parent.removeChild(e.bullet_new_icon),sceneMaster.openModal(new myShop)},t.prototype.openShopFun=function(){sceneMaster.openModal(new teachModal)},t.prototype.openRankFun=function(){sceneMaster.openModal(new rankModal)},t.prototype.openGiftFun=function(){var e=this;e.red_dot.parent&&e.red_dot.parent.removeChild(e.red_dot),sceneMaster.openModal(new giftModal)},t}(eui.Component);__reflect(startScene.prototype,"startScene",["eui.UIComponent","egret.DisplayObject"]),window.Main=Main;